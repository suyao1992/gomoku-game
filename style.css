* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

/* 闁稿繈鍔岄惈鍡涙嚄鐏炵偓鐝悘锟?*/
#game-bg {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 0;
    background-image: url('assets/images/bg.webp');
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    transition: background-image 0.8s ease-in-out,
        filter 0.3s ease;
    /* 濮掓稒枪閿熻棄銆掗幇锟界秮闁煎啿鏈▍娆撴晬閸繃绂堥柣妤€娲ゆ慨鐐存姜閽樺锟介柟瀛樼墪閵囨垹鎷归妷锔斤拷闁哄嫬澧介妵姘舵晬?*/
    background-color: #1a1a2e;
}

body {
    font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
    background-color: #020817;
    /* 闁稿繑绮岀花鎶芥嚄鐏炵偓鐝柤锟?*/
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 20px;
    position: relative;
    z-index: 1;
}

.container {
    text-align: center;
    position: relative;
}

h1 {
    color: #fff;
    margin-bottom: 20px;
    font-size: 2.5em;
    text-shadow: 0 0 20px rgba(0, 212, 255, 0.5);
}

.music-btn {
    position: absolute;
    top: 0;
    left: 0;
    padding: 8px 16px;
    font-size: 14px;
    background: linear-gradient(145deg, #2a2a4a, #1a1a3a);
    color: #888;
    border: 1px solid #444;
    border-radius: 20px;
    cursor: pointer;
    transition: all 0.3s;
}

.music-btn:hover {
    background: linear-gradient(145deg, #3a3a5a, #2a2a4a);
    color: #aaa;
}

.music-btn.playing {
    color: #a855f7;
    border-color: #a855f7;
    box-shadow: 0 0 15px rgba(168, 85, 247, 0.4);
    animation: pulse 2s infinite;
}

@keyframes pulse {

    0%,
    100% {
        box-shadow: 0 0 15px rgba(168, 85, 247, 0.4);
    }

    50% {
        box-shadow: 0 0 25px rgba(168, 85, 247, 0.6);
    }
}

/* 闂婃娊鍣洪幒褍鍩?*/
.volume-control {
    position: absolute;
    top: 0;
    left: 110px;
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 6px 12px;
    background: rgba(30, 30, 50, 0.8);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 20px;
}

.volume-icon {
    font-size: 1em;
    opacity: 0.7;
}

.volume-slider {
    width: 80px;
    height: 4px;
    -webkit-appearance: none;
    appearance: none;
    background: rgba(255, 255, 255, 0.15);
    border-radius: 2px;
    outline: none;
    cursor: pointer;
}

.volume-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 14px;
    height: 14px;
    background: #a855f7;
    border-radius: 50%;
    cursor: pointer;
    box-shadow: 0 0 8px rgba(168, 85, 247, 0.5);
}

.volume-slider::-moz-range-thumb {
    width: 14px;
    height: 14px;
    background: #a855f7;
    border-radius: 50%;
    cursor: pointer;
    border: none;
}

.game-info {
    margin-bottom: 20px;
    color: #fff;
}

.player-info {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 20px;
    margin-bottom: 10px;
}

.player {
    padding: 10px 20px;
    border-radius: 10px;
    font-weight: bold;
    font-size: 1.1em;
}

.black-player {
    background: linear-gradient(145deg, #2a2a2a, #1a1a1a);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
}

.white-player {
    background: linear-gradient(145deg, #f0f0f0, #d0d0d0);
    color: #333;
    box-shadow: 0 4px 15px rgba(255, 255, 255, 0.2);
}

.vs {
    font-size: 1.5em;
    font-weight: bold;
    color: #ffd700;
}

.current-turn {
    font-size: 1.2em;
    margin-top: 10px;
    padding: 10px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    display: inline-block;
}

.game-mode-display {
    margin-top: 10px;
    font-size: 1.1em;
    color: #00d4ff;
}

.game-timer {
    margin-top: 12px;
    font-size: 1.3em;
    color: #ffd700;
    font-weight: bold;
    padding: 8px 20px;
    background: rgba(255, 215, 0, 0.1);
    border-radius: 8px;
    display: inline-block;
    border: 1px solid rgba(255, 215, 0, 0.3);
    text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
    font-family: 'Courier New', monospace;
}

/* ============ 主菜单样式 (Target Bento Grid - Figure 2) ============ */
.main-menu-view {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 90%;
    max-width: 600px;
    /* Reduced max-width for better vertical look like a mobile app/game menu */
    min-width: 320px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 30px;
    z-index: 100;
}

@media (max-width: 768px) {
    .main-menu-view {
        max-width: 100%;
        top: 50%;
        gap: 20px;
    }
}

/* P0 FIX: iPhone / Mobile specific main menu fix */
/* 同时支持触摸设备和小屏幕，不仅仅靠 pointer: coarse */
@media (max-width: 600px) {

    /* Force body to not center items vertically on mobile */
    body {
        display: block !important;
        align-items: stretch !important;
        min-height: 100vh;
        min-height: -webkit-fill-available;
        /* iOS Safari fix */
        padding: 0 !important;
    }

    /* Container must expand to full viewport */
    .container {
        display: block !important;
        width: 100% !important;
        min-height: 100vh !important;
        min-height: -webkit-fill-available !important;
        /* iOS Safari */
        height: auto !important;
        padding: 0 !important;
        padding-bottom: 100px !important;
        overflow-y: auto !important;
        overflow-x: hidden !important;
    }

    /* Main menu must be visible and take full width */
    .main-menu-view {
        position: relative !important;
        top: auto !important;
        left: auto !important;
        transform: none !important;
        width: 100% !important;
        max-width: 100% !important;
        min-width: 0 !important;
        min-height: auto !important;
        padding: 15px !important;
        padding-top: max(15px, env(safe-area-inset-top)) !important;
        padding-bottom: max(30px, env(safe-area-inset-bottom)) !important;
        gap: 15px !important;
        margin: 0 auto !important;
        display: flex !important;
        flex-direction: column !important;
        align-items: center !important;
    }

    /* Ensure menu is never hidden when it should be visible */
    .main-menu-view:not(.hidden) {
        display: flex !important;
        visibility: visible !important;
        opacity: 1 !important;
    }


    /* Hero card mobile adjustments */
    .hero-card {
        height: 130px;
        padding: 0 20px;
    }

    .hero-title {
        font-size: 24px;
        letter-spacing: 1px;
    }

    .hero-subtitle {
        font-size: 13px;
        margin-bottom: 12px;
    }

    .online-status-pill {
        font-size: 11px;
        padding: 6px 12px;
    }

    .card-decor-img {
        font-size: 40px;
    }

    /* Row cards mobile adjustments */
    .row-card {
        height: 75px;
    }

    .card-icon-small {
        font-size: 26px;
    }

    .card-title {
        font-size: 14px;
    }

    /* Wide card adjustments */
    .wide-card {
        height: 65px !important;
        margin-top: 5px;
    }

    .wide-label {
        font-size: 16px;
    }

    /* Bottom dock on mobile */
    .bottom-dock {
        width: 100%;
        height: 65px;
        margin-top: 15px;
        padding: 0 15px;
        border-radius: 20px;
        padding-bottom: max(10px, env(safe-area-inset-bottom));
    }

    .dock-icon {
        font-size: 20px;
    }

    .dock-label {
        font-size: 10px;
    }

    /* P0 FIX: Version announcement modal on mobile */
    .version-content {
        width: 95vw !important;
        max-width: 95vw !important;
        max-height: 80vh;
        padding: 20px 15px;
        overflow-y: auto;
    }

    .version-header {
        flex-wrap: wrap;
        gap: 8px;
    }

    .version-header h2 {
        font-size: 1.2em;
    }

    .version-header .subtitle {
        display: none;
        /* Hide confusing subtitle on mobile */
    }

    .version-section h3 {
        font-size: 0.95em;
    }

    .version-section li {
        font-size: 0.85em;
    }

    .version-footer {
        flex-direction: column;
        gap: 12px;
    }

    .version-close-btn {
        width: 100%;
    }

    /* P0 FIX: Name input modal on mobile */
    .name-input-content {
        width: 95vw !important;
        max-width: 95vw !important;
        max-height: 85vh;
        overflow-y: auto;
    }

    /* User info pill on mobile */
    .user-info-pill {
        padding: 8px 12px 8px 8px;
    }

    .user-avatar-small {
        width: 40px;
        height: 40px;
        font-size: 22px;
    }

    #menu-user-name {
        font-size: 14px;
    }

    .user-rank-status {
        font-size: 11px;
    }
}



/* 1. Top Bar */
.menu-top-bar {
    display: flex;
    justify-content: flex-start;
    /* Align left */
    width: 100%;
    padding: 0 5px;
}

.user-info-pill {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 10px 20px 10px 10px;
    /* Right padding for text balance */
    background: rgba(30, 30, 40, 0.4);
    /* Softer background */
    backdrop-filter: blur(12px);
    border: 1px solid rgba(255, 255, 255, 0.08);
    border-radius: 50px;
}

.user-avatar-small {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    background: linear-gradient(135deg, #3a3a5a, #2a2a4a);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 28px;
    border: 2px solid rgba(255, 255, 255, 0.2);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
}

.user-name-text {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

#menu-user-name {
    color: #fff;
    font-weight: 700;
    font-size: 16px;
    letter-spacing: 0.5px;
}

.user-rank-status {
    color: rgba(255, 255, 255, 0.6);
    font-size: 12px;
    font-weight: 500;
}

/* 2. Menu Grid (Bento Layout) */
.menu-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 15px;
    /* Tighter gap */
    width: 100%;
}

.menu-card {
    position: relative;
    border-radius: 24px;
    /* Rounder corners */
    cursor: pointer;
    overflow: hidden;
    transition: all 0.25s cubic-bezier(0.25, 0.8, 0.25, 1);
    border: 1px solid rgba(255, 255, 255, 0.15);
    /* Stronger border */
    box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
    /* Glassmorphism shadow */
}

.menu-card:active {
    transform: scale(0.96);
}

.menu-card:hover {
    border-color: rgba(255, 255, 255, 0.4);
    transform: translateY(-2px);
}

/* Hero Card (Span 2) - Soft Pink/Purple Gradient (Target Match) */
.hero-card {
    grid-column: span 2;
    height: 180px;
    /* Purple to Peach/Orange Gradient */
    background: linear-gradient(90deg, #a855f7 0%, #ffa726 100%);
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 50px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    box-shadow: 0 20px 50px rgba(168, 85, 247, 0.3);
    overflow: hidden;
    /* Ensure icon doesn't overflow */
}

.hero-card:hover {
    transform: translateY(-5px) scale(1.02);
    box-shadow: 0 30px 60px rgba(168, 85, 247, 0.4);
    border-color: rgba(255, 255, 255, 0.4);
}

.hero-card::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 60%);
    opacity: 0;
    transition: opacity 0.5s;
    pointer-events: none;
}

.hero-card:hover::before {
    opacity: 1;
}

.card-content {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    justify-content: center;
    z-index: 10;
}

.hero-title {
    font-size: 38px;
    font-weight: 800;
    color: #fff;
    margin-bottom: 12px;
    /* Increased separation */
    line-height: 1.1;
    letter-spacing: 2px;
    /* More breathable */
    text-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    /* Softer shadow */
    white-space: nowrap;
}

.hero-subtitle {
    font-size: 15px;
    color: rgba(255, 255, 255, 0.95);
    margin-bottom: 24px;
    /* More space before pill */
    font-weight: 500;
    letter-spacing: 0.5px;
}

.online-status-pill {
    display: inline-flex;
    align-items: center;
    gap: 12px;
    /* Uniform gap */

    /* Glass Pill Style */
    background: rgba(0, 0, 0, 0.2);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);

    padding: 8px 18px;
    border-radius: 100px;
    /* Fully rounded */
    border: 1px solid rgba(255, 255, 255, 0.15);
    /* Subtle border */
    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1);
    /* Top inner light */

    font-size: 13px;
    font-weight: 600;
    color: rgba(255, 255, 255, 0.95);
    white-space: nowrap;
    /* Prevent wrapping */
}

/* Override inline divider style via child selector if possible, or just style spans */
.online-status-pill>span {
    display: flex;
    align-items: center;
}

.status-dot {
    width: 6px;
    height: 6px;
    background-color: #4ade80;
    border-radius: 50%;
    box-shadow: 0 0 8px #4ade80;
    margin-right: -4px;
    /* Tweak spacing with text */
}

.card-decor-img {
    font-size: 60px;
    /* Smaller to fit nicely */
    filter: drop-shadow(0 15px 30px rgba(0, 0, 0, 0.2));
    transform: rotate(-10deg);
    transition: transform 0.3s ease;
    margin-right: 10px;
    /* Keep within bounds */
    flex-shrink: 0;
    /* Don't compress */
}

.hero-card:hover .card-decor-img {
    transform: rotate(0deg) scale(1.1);
}

/* Glass Card Pro (Matches Reference) */
.glass-card {
    background: linear-gradient(180deg,
            rgba(255, 255, 255, 0.12) 0%,
            rgba(255, 255, 255, 0.06) 40%,
            rgba(255, 255, 255, 0.02) 100%);
    backdrop-filter: blur(25px);
    -webkit-backdrop-filter: blur(25px);
    border-top: 1px solid rgba(255, 255, 255, 0.45);
    border-bottom: 1px solid rgba(0, 0, 0, 0.3);
    border-left: 1px solid rgba(255, 255, 255, 0.1);
    border-right: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow:
        inset 0 1px 0 rgba(255, 255, 255, 0.2),
        0 8px 30px rgba(0, 0, 0, 0.3);
    border-radius: 12px;
}

/* Row Cards (Horizontal Layout) */
.row-card {
    height: 85px;
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: center;
    padding: 0 20px;
    gap: 15px;
    transition: all 0.2s ease;
}

.row-card:active {
    transform: scale(0.98);
}

.row-card-content {
    display: flex;
    flex-direction: row;
    align-items: center;
    gap: 15px;
}

.card-icon-small {
    font-size: 32px;
    filter: drop-shadow(0 2px 5px rgba(0, 0, 0, 0.3));
    margin-bottom: 0;
    color: rgba(255, 255, 255, 0.9);
}

.card-text {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
}

.card-title {
    font-size: 16px;
    font-weight: 600;
    color: #fff;
    white-space: nowrap;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
}

/* Wide Card (Spectate Banner) */
.wide-card {
    grid-column: span 2;
    height: 80px !important;
    display: flex !important;
    align-items: center;
    justify-content: flex-start;
    /* Left align text */

    background: url('assets/banner_spectate.png') center/cover no-repeat !important;
    border-radius: 12px !important;
    border: 1px solid rgba(255, 255, 255, 0.3);

    position: relative;
    overflow: hidden;
    margin-top: 10px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5) !important;
}

.wide-card::before {
    content: '';
    position: absolute;
    inset: 0;
    /* Gradient overlay for text readability */
    background: linear-gradient(90deg, rgba(8, 5, 20, 0.8) 0%, rgba(8, 5, 20, 0.1) 60%);
    z-index: 1;
}

.wide-content {
    position: relative;
    z-index: 2;
    padding-left: 30px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.wide-icon {
    display: none;
    /* Icon optional with big text */
}

.wide-label {
    font-size: 20px;
    font-weight: 700;
    color: #fff;
    letter-spacing: 1px;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
}

/* 3. Bottom Dock */
/* 3. Bottom Dock */
.bottom-dock {
    /* Changed from fixed to static so it flows below the content */
    width: 100%;
    max-width: 600px;
    height: 80px;
    padding: 0 20px;
    margin-top: 30px;
    /* Space from grid */

    display: flex;
    justify-content: space-between;
    align-items: center;

    /* Premium Glass Style */
    background: linear-gradient(180deg,
            rgba(30, 32, 45, 0.85) 0%,
            rgba(30, 32, 45, 0.6) 100%);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);

    border-radius: 40px;
    border-top: 1px solid rgba(255, 255, 255, 0.3);
    /* Bevel top */
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    border-left: 1px solid rgba(255, 255, 255, 0.1);
    /* Subtle side */
    border-right: 1px solid rgba(255, 255, 255, 0.1);

    box-shadow:
        inset 0 1px 0 rgba(255, 255, 255, 0.15),
        0 15px 40px rgba(0, 0, 0, 0.4);

    flex-shrink: 0;
    /* Prevent shrinking */
}

.dock-item {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
    color: rgba(255, 255, 255, 0.5);
    transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    cursor: pointer;
}

.dock-item:hover {
    color: #fff;
    transform: translateY(-5px);
}

.dock-item:active {
    transform: scale(0.95);
}

.dock-icon {
    font-size: 24px;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.5));
}

.dock-label {
    font-size: 11px;
    font-weight: 500;
}

/* Mobile Adjustments */
@media (max-width: 480px) {
    .hero-title {
        font-size: 26px;
    }

    .hero-card {
        height: 140px;
        padding: 0 20px;
    }

    .card-decor-img {
        font-size: 60px;
    }

    .row-card {
        height: 90px;
        padding: 0 15px;
    }

    .card-icon-small {
        font-size: 28px;
    }

    .card-title {
        font-size: 15px;
    }

    .bottom-dock {
        width: 94%;
        height: 70px;
        bottom: 15px;
    }
}

/* ========== CINEMATIC UI: VISUAL NOVEL STYLE ========== */
.game-layout {
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: stretch;
    gap: 10px;
    /* Compact Gap */
    margin-top: 20px;
}

.game-container {
    position: relative;
    padding: 10px;
    background: rgba(0, 0, 0, 0.4);
    /* The "black film" */
    border-radius: 8px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(10px);
    display: flex;
    justify-content: center;
    align-items: center;
    /* Ensure it has width for resizeBoard */
    width: 620px;
    max-width: 100%;
}

#board {
    border-radius: 4px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    cursor: crosshair;
    background-color: #DEB887;
    /* Wood color fallback */
}

/* 1. Character Card (Cinematic Container) */
.character-wrapper {
    position: relative;
    width: 300px;
    max-width: 100%;
    height: 600px;
    /* Locked Height */

    background: #0f0f1a;
    border-radius: 15px;
    /* Enhanced Shadow for Depth */
    box-shadow: 0 20px 50px rgba(0, 0, 0, 0.7);
    border: 1px solid rgba(0, 212, 255, 0.2);
    overflow: hidden;
    /* Clips image and overlays */
}

/* 2. Portrait Layer (Full Canvas) */
.char-frame {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    margin: 0;
    padding: 0;
    border: none;
    border-radius: 0;
    background: linear-gradient(180deg, #1a1a2e 0%, #000 100%);
    z-index: 1;
}

.char-sprite {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center top;
    transition: transform 0.5s ease;
}

/* Hover Effect: Gentle Zoom */
.character-wrapper:hover .char-sprite {
    transform: scale(1.03);
}

/* 3. Dialogue Overlay (Glass Effect) */
.dialogue-box {
    position: absolute;
    bottom: 20px;
    left: 15px;
    right: 15px;
    height: 120px;
    /* Fixed Height */

    background: rgba(10, 16, 30, 0.85);
    /* Dark Glass */
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);

    border: 1px solid rgba(0, 212, 255, 0.25);
    border-top: 1px solid rgba(0, 212, 255, 0.5);
    /* Highlight Top Edge */
    border-radius: 12px;

    /* Top padding allows name badge to sit comfortably if needed, but we position badge outside */
    padding: 25px 15px 15px 15px;

    z-index: 10;

    display: flex;
    flex-direction: column;
    justify-content: center;
    overflow-y: auto;

    animation: slideUp 0.5s ease-out;
}

.dialogue-box p {
    margin: 0;
    color: #e0e0e0;
    font-size: 0.95em;
    line-height: 1.6;
    text-align: center;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.8);
}

/* 4. Name Badge (Floating) */
.char-name {
    position: absolute;
    bottom: 130px;
    /* Overlaps Dialogue Box Top Edge (120+20=140 bottom) */
    left: 25px;
    z-index: 20;
    width: auto;
    height: auto;

    background: #00d4ff;
    color: #000;
    font-size: 0.9em;
    font-weight: 800;
    /* Extra Bold */
    padding: 4px 12px;
    border-radius: 4px;
    box-shadow: 0 2px 10px rgba(0, 212, 255, 0.4);
    letter-spacing: 1px;
    margin: 0;
    text-transform: uppercase;
}

/* Status Dot */
.char-name::after {
    content: '';
    display: inline-block;
    width: 6px;
    height: 6px;
    margin-left: 6px;
    margin-bottom: 2px;
    background: #00ff00;
    /* Active */
    border-radius: 50%;
    animation: breathe 2s infinite;
}

@keyframes slideUp {
    from {
        transform: translateY(30px);
        opacity: 0;
    }

    to {
        transform: translateY(0);
        opacity: 1;
    }
}

@keyframes breathe {
    0% {
        box-shadow: 0 0 0 0 rgba(0, 255, 0, 0.7);
    }

    70% {
        box-shadow: 0 0 0 4px rgba(0, 255, 0, 0);
    }

    100% {
        box-shadow: 0 0 0 0 rgba(0, 255, 0, 0);
    }
}

/* Ensure VFX sits between */
.vfx-overlay {
    z-index: 5;
}

@keyframes dialogueFade {
    from {
        opacity: 0;
        transform: translateY(10px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* --- 閻熸瑦甯熸竟濠囨偐閼哥鍋撴担鍝勶拷闁轰礁鐗忕悮锟?--- */

/* 1. 鐎垫澘鎳忓┃鈧?闂傚啯褰冪亸浠嬫晬濮樺厖姘︾€靛府鎷烽幊鐘诲触?*/
.state-idle .char-sprite {
    animation: breathe 4s infinite ease-in-out;
}

/* 2. 婵烇絽宕€硅櫕娼婚幇锟芥毈闁挎稒淇洪幗鎴︽嚌閸欏濮㈤梻鈧?+ 缂佸绉存禍鏇㈠绩閹佷海 */
.state-calc .char-sprite {
    filter: drop-shadow(0 0 15px rgba(0, 150, 255, 0.8)) brightness(1.2);
    transform: scale(1.05);
}

.state-calc .vfx-overlay {
    opacity: 1;
    background: radial-gradient(circle at center, transparent 30%, rgba(0, 150, 255, 0.15) 100%);
    animation: calcPulse 1.5s infinite;
}

@keyframes calcPulse {

    0%,
    100% {
        opacity: 0.5;
    }

    50% {
        opacity: 1;
    }
}

/* 3. 缂備焦绻冨锟?闁衡偓鐠囨彃姣婇柨娑欐皑閻忔盯姊婚幘锟界細闁革拷?+ 缂佷勘鍨兼竟濠囨⒒閿熻棄甯?*/
.state-attack .char-sprite {
    filter: drop-shadow(0 0 20px rgba(255, 50, 50, 0.8)) brightness(1.3) contrast(1.1);
    animation: shake 0.5s cubic-bezier(.36, .07, .19, .97) both;
}

.state-attack .vfx-overlay {
    opacity: 1;
    background: radial-gradient(circle at center, rgba(255, 50, 50, 0.3) 0%, transparent 70%);
    animation: attackFlash 0.2s ease-out;
}

@keyframes attackFlash {
    0% {
        opacity: 1;
        background: rgba(255, 255, 255, 0.5);
    }

    100% {
        opacity: 0.5;
    }
}

/* 4. 闁艰櫕绮岄崺鍕晬濮樿泛娅ㄩ柤瑙勫絻閸樻粍娼?+ 闁告ê锟介幓鈺呭箛?*/
.state-win .char-sprite {
    filter: brightness(1.3) contrast(1.2) drop-shadow(0 0 25px gold);
    transform: scale(1.08);
}

.state-win .vfx-overlay {
    opacity: 1;
    background: radial-gradient(circle at 50% 30%, rgba(255, 215, 0, 0.3) 0%, transparent 60%);
    animation: winGlow 2s infinite;
}

@keyframes winGlow {

    0%,
    100% {
        opacity: 0.6;
    }

    50% {
        opacity: 1;
    }
}

.state-win .char-name {
    color: #ffd700;
    text-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
    animation: nameGlow 1s infinite;
}

@keyframes nameGlow {

    0%,
    100% {
        text-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
    }

    50% {
        text-shadow: 0 0 35px rgba(255, 215, 0, 1);
    }
}

/* 5. 闁瑰瓨枪鐟欙箓鏁嶅锟芥珚闂傚懏绮嶉弲銉╁几?(Glitch) */
.state-lose .char-sprite {
    filter: grayscale(80%) contrast(150%) brightness(0.8);
    animation: glitch-anim 0.15s infinite;
}

.state-lose .vfx-overlay {
    opacity: 1;
    background: repeating-linear-gradient(0deg,
            transparent,
            transparent 2px,
            rgba(255, 0, 0, 0.1) 2px,
            rgba(255, 0, 0, 0.1) 4px);
    animation: scanlines 0.1s infinite;
}

.state-lose .char-name {
    color: #ff4444;
    animation: glitchText 0.3s infinite;
}

@keyframes glitchText {
    0% {
        transform: translateX(0);
    }

    20% {
        transform: translateX(-2px);
        color: #ff0000;
    }

    40% {
        transform: translateX(2px);
        color: #00ff00;
    }

    60% {
        transform: translateX(-1px);
    }

    80% {
        transform: translateX(1px);
        color: #0000ff;
    }

    100% {
        transform: translateX(0);
    }
}

@keyframes scanlines {
    0% {
        background-position: 0 0;
    }

    100% {
        background-position: 0 4px;
    }
}

/* --- 缂佺姭鍋撻柛妤佹礈濞堟垿宕楅幎鑺ユ殯閻拷鍐ㄐ楅柣锟?--- */
@keyframes breathe {

    0%,
    100% {
        opacity: 0.9;
        transform: scale(1);
    }

    50% {
        opacity: 1;
        transform: scale(1.02);
    }
}

@keyframes shake {

    10%,
    90% {
        transform: translate3d(-2px, 0, 0);
    }

    20%,
    80% {
        transform: translate3d(3px, 0, 0);
    }

    30%,
    50%,
    70% {
        transform: translate3d(-5px, 0, 0);
    }

    40%,
    60% {
        transform: translate3d(5px, 0, 0);
    }
}

@keyframes glitch-anim {
    0% {
        transform: translate(0);
    }

    20% {
        transform: translate(-3px, 2px);
    }

    40% {
        transform: translate(-3px, -2px);
    }

    60% {
        transform: translate(3px, 2px);
    }

    80% {
        transform: translate(3px, -2px);
    }

    100% {
        transform: translate(0);
    }
}

#board {
    border-radius: 10px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
    cursor: pointer;
}

.controls {
    display: flex;
    justify-content: center;
    gap: 15px;
    flex-wrap: wrap;
}

.btn {
    padding: 12px 24px;
    font-size: 16px;
    font-weight: bold;
    color: #fff;
    background: linear-gradient(145deg, #3a86ff, #2563eb);
    border: none;
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.3s;
    box-shadow: 0 4px 15px rgba(58, 134, 255, 0.3);
}

.btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(58, 134, 255, 0.5);
}

.btn:active {
    transform: translateY(0);
}

/* Modal */
.modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    backdrop-filter: blur(5px);
}

.modal.hidden {
    display: none;
}

.modal-content {
    background: linear-gradient(145deg, #1e1e3f, #151530);
    padding: 40px;
    border-radius: 20px;
    text-align: center;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5), 0 0 40px rgba(0, 212, 255, 0.1);
    border: 1px solid rgba(0, 212, 255, 0.2);
    animation: modalIn 0.3s ease-out;
}

@keyframes modalIn {
    from {
        transform: scale(0.9);
        opacity: 0;
    }

    to {
        transform: scale(1);
        opacity: 1;
    }
}

.modal-content h2 {
    color: #fff;
    margin-bottom: 30px;
    font-size: 1.8em;
    text-shadow: 0 0 20px rgba(0, 212, 255, 0.5);
}

.mode-buttons {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.mode-btn {
    padding: 20px 40px;
    font-size: 1.2em;
    background: linear-gradient(145deg, #2a2a5a, #1a1a4a);
    border: 2px solid transparent;
    transition: all 0.3s;
}

.mode-btn:hover {
    border-color: #00d4ff;
    box-shadow: 0 0 30px rgba(0, 212, 255, 0.3);
}

/* RPS */
.rps-content {
    min-width: 500px;
}

.rps-game {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 30px;
    margin: 30px 0;
}

.rps-player {
    background: linear-gradient(145deg, #252550, #1a1a40);
    padding: 25px;
    border-radius: 15px;
    min-width: 150px;
    border: 2px solid transparent;
    transition: all 0.3s;
}

.rps-player.active {
    border-color: #00d4ff;
    box-shadow: 0 0 25px rgba(0, 212, 255, 0.4);
}

.rps-player.winner {
    border-color: #ffd700;
    box-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
    animation: winnerGlow 1s infinite;
}

@keyframes winnerGlow {

    0%,
    100% {
        box-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
    }

    50% {
        box-shadow: 0 0 50px rgba(255, 215, 0, 0.8);
    }
}

.rps-label {
    font-size: 1.2em;
    color: #fff;
    margin-bottom: 15px;
    font-weight: bold;
}

.rps-choices {
    display: flex;
    gap: 10px;
    justify-content: center;
}

.rps-btn {
    font-size: 2.5em;
    padding: 15px;
    background: linear-gradient(145deg, #3a3a6a, #2a2a5a);
    border: 2px solid #444;
    border-radius: 15px;
    cursor: pointer;
    transition: all 0.3s;
}

.rps-btn:hover:not(:disabled) {
    transform: scale(1.15);
    border-color: #00d4ff;
    box-shadow: 0 0 20px rgba(0, 212, 255, 0.4);
}

.rps-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.rps-vs {
    font-size: 2em;
    color: #ffd700;
    font-weight: bold;
    text-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
}

.rps-selected {
    font-size: 4em;
    margin-top: 15px;
    animation: popIn 0.3s ease-out;
}

@keyframes popIn {
    from {
        transform: scale(0);
    }

    to {
        transform: scale(1);
    }
}

.rps-result {
    font-size: 1.4em;
    color: #00ff88;
    margin-top: 20px;
    padding: 15px;
    background: rgba(0, 255, 136, 0.1);
    border-radius: 10px;
    animation: fadeIn 0.5s;
}

.rps-result.draw {
    color: #ffd700;
    background: rgba(255, 215, 0, 0.1);
}

.rps-waiting {
    color: #888;
    margin-top: 15px;
    font-size: 1.1em;
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* 闁稿﹥甯熼敓浠嬪籍?*/
.countdown-content {
    text-align: center;
}

.countdown-number {
    font-size: 8em;
    font-weight: bold;
    color: #00d4ff;
    text-shadow: 0 0 50px rgba(0, 212, 255, 0.8), 0 0 100px rgba(0, 212, 255, 0.5);
    animation: countPop 0.5s ease-out;
}

@keyframes countPop {
    0% {
        transform: scale(1.5);
        opacity: 0;
    }

    50% {
        transform: scale(0.9);
    }

    100% {
        transform: scale(1);
        opacity: 1;
    }
}


/* 闁煎墽鏌夐崕銊ワ拷閸︼拷宕?*/
.winner-content {
    min-width: 350px;
}

.winner-content h2 {
    font-size: 2em;
    margin-bottom: 30px;
    animation: winText 0.5s ease-out;
}

@keyframes winText {
    0% {
        transform: scale(0);
    }

    50% {
        transform: scale(1.2);
    }

    100% {
        transform: scale(1);
    }
}

.winner-buttons {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.winner-btn {
    padding: 15px 30px;
    font-size: 1.1em;
}

.winner-btn.secondary {
    background: linear-gradient(145deg, #4a4a6a, #3a3a5a);
    box-shadow: 0 4px 15px rgba(100, 100, 150, 0.3);
}

.winner-btn.secondary:hover {
    box-shadow: 0 6px 20px rgba(100, 100, 150, 0.5);
}

/* AI闁癸拷绻嗛埀锟?*/
.ai-thinking {
    position: fixed;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%);
    background: linear-gradient(145deg, #2a2a5a, #1a1a4a);
    color: #00d4ff;
    padding: 15px 30px;
    border-radius: 30px;
    font-size: 1.1em;
    box-shadow: 0 5px 25px rgba(0, 0, 0, 0.3);
    animation: thinking 1.5s infinite;
    z-index: 100;
}

@keyframes thinking {

    0%,
    100% {
        opacity: 1;
    }

    50% {
        opacity: 0.5;
    }
}

.hidden {
    display: none !important;
}

/* ========== 闁哄倻澧楄啯鐎碉拷绻橀埀锟斤拷鐎氣晳I闁哄秴鍢茬槐锟?========== */

.mode-select-content {
    min-width: 0;
    /* 缁夊娅庨崶鍝勭暰閺堚偓鐏忓繐锟芥惔锟?*/
    width: min(450px, 90vw);
    /* 閸濆秴绨插蹇擄拷鎼达拷 */
    max-width: 550px;
    max-height: 70vh;
    overflow-y: auto !important;
    padding-right: 5px;

    /* Mobile optimization */
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: contain;
    pointer-events: auto;
    flex-shrink: 0;
}

/* 閼凤拷鐣炬稊澶嬬泊閸斻劍娼弽宄扮础 */
.mode-select-content::-webkit-scrollbar {
    width: 8px;
}

.mode-select-content::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.2);
    border-radius: 4px;
}

.mode-select-content::-webkit-scrollbar-thumb {
    background: rgba(0, 212, 255, 0.4);
    border-radius: 4px;
}

.mode-select-content::-webkit-scrollbar-thumb:hover {
    background: rgba(0, 212, 255, 0.7);
}

.mode-section {
    margin-bottom: 12px;
    border-radius: 12px;
    overflow: hidden;
    background: linear-gradient(145deg, rgba(40, 40, 80, 0.6), rgba(25, 25, 55, 0.8));
    border: 1px solid rgba(255, 255, 255, 0.08);
    transition: all 0.3s ease;
}

.mode-section:hover {
    border-color: rgba(0, 212, 255, 0.3);
    box-shadow: 0 0 20px rgba(0, 212, 255, 0.1);
}

/* 閸欙拷鍋ｉ崙鑽ゆ畱閸栧搫鐓欓弽鍥拷婢讹拷 */
.section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px 20px;
    cursor: pointer;
    background: linear-gradient(145deg, rgba(60, 60, 100, 0.4), rgba(40, 40, 70, 0.6));
    transition: all 0.3s ease;
    user-select: none;
}

.section-header:hover {
    background: linear-gradient(145deg, rgba(80, 80, 120, 0.5), rgba(50, 50, 80, 0.7));
}

.section-header:hover .section-title {
    color: #00d4ff;
    text-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
}

.section-title {
    color: #fff;
    font-size: 1.1em;
    font-weight: 600;
    letter-spacing: 1px;
    transition: all 0.3s ease;
}

/* 鐏炴洖绱?閺€鎯版崳缁狅拷銇?*/
.section-arrow {
    color: #888;
    font-size: 0.9em;
    transition: transform 0.3s ease, color 0.3s ease;
}

.section-header:hover .section-arrow {
    color: #00d4ff;
}

/* 鐏炴洖绱戦悩鑸碘偓浣烘畱缁狅拷銇旈弮瀣祮 */
.mode-section:not(.collapsed) .section-arrow {
    transform: rotate(180deg);
    color: #00d4ff;
}

/* 閸愬懎锟介崠鍝勭厵 - 閸欙拷濮岄崣锟?*/
.section-content {
    max-height: 1000px;
    /* 婢х偛銇囬張鈧径褔鐝惔锔夸簰鐎瑰湱鎾奸弴鏉戯拷閸愬懎锟?*/
    opacity: 1;
    padding: 12px 15px 15px;
    transition: max-height 0.4s ease, opacity 0.3s ease, padding 0.3s ease;
    overflow-y: auto;
    /* 閺€閫涜礋auto閸忎浇锟藉姘З */
}

/* 閹舵ê褰旈悩鑸碘偓锟?*/
.mode-section.collapsed .section-content {
    max-height: 0;
    opacity: 0;
    padding-top: 0;
    padding-bottom: 0;
}

/* 闁轰礁鎳嶇花銊ノ熼垾宕囩闁圭锟介幐锟?*/
.story-mode-buttons,
.free-mode-buttons {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.story-main-btn,
.free-btn {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 18px 20px;
    text-align: left;
    background: linear-gradient(145deg, #2a2a5a, #1a1a4a);
    border: 2px solid transparent;
    transition: all 0.3s;
}

.story-main-btn {
    background: linear-gradient(145deg, #3a2a5a, #2a1a4a);
}

.story-main-btn:hover {
    border-color: #a855f7;
    box-shadow: 0 0 25px rgba(168, 85, 247, 0.4);
    transform: translateX(5px);
}

.free-btn:hover {
    border-color: #00d4ff;
    box-shadow: 0 0 25px rgba(0, 212, 255, 0.4);
    transform: translateX(5px);
}

.btn-icon {
    font-size: 2em;
    width: 50px;
    text-align: center;
}

.btn-text {
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.btn-title {
    font-size: 1.1em;
    font-weight: bold;
    color: #fff;
}

.btn-subtitle {
    font-size: 0.85em;
    color: #888;
    font-weight: normal;
}

/* ========== 婵炴挴鏅滈弲鐘绘儗閵夛附鐓€闁稿繐鍟垮畷閬嶆焻婢跺锟界€碉拷婀遍悰锟?========== */

.mission-select-content {
    min-width: 500px;
    max-width: 650px;
    max-height: 80vh;
    display: flex;
    flex-direction: column;
}

.mission-select-header {
    position: relative;
    padding-bottom: 15px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    margin-bottom: 20px;
}

.mission-select-header h2 {
    margin-bottom: 10px;
}

.progress-text {
    color: #a855f7;
    font-size: 1em;
    margin: 0;
}

.close-btn {
    position: absolute;
    top: 0;
    right: 0;
    width: 40px;
    height: 40px;
    background: rgba(255, 255, 255, 0.1);
    border: none;
    border-radius: 50%;
    color: #888;
    font-size: 1.2em;
    cursor: pointer;
    transition: all 0.3s;
}

.close-btn:hover {
    background: rgba(255, 100, 100, 0.3);
    color: #ff6666;
}

.mission-list {
    overflow-y: auto;
    max-height: 50vh;
    display: flex;
    flex-direction: column;
    gap: 12px;
    padding-right: 10px;
}

/* 婵犲﹥鑹炬慨鈺呭级閳╁啰澹夌€碉拷?*/
.mission-list::-webkit-scrollbar {
    width: 6px;
}

.mission-list::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 3px;
}

.mission-list::-webkit-scrollbar-thumb {
    background: rgba(168, 85, 247, 0.5);
    border-radius: 3px;
}

/* 闁稿繐鍟垮畷閬嶅础閿涘嫬锟?*/
.mission-card {
    display: flex;
    align-items: stretch;
    background: linear-gradient(145deg, #252545, #1a1a35);
    border-radius: 12px;
    overflow: hidden;
    border: 2px solid transparent;
    transition: all 0.3s;
    cursor: pointer;
}

.mission-card.unlocked:hover {
    border-color: #a855f7;
    box-shadow: 0 0 20px rgba(168, 85, 247, 0.3);
    transform: translateX(5px);
}

.mission-card.locked {
    opacity: 0.5;
    cursor: not-allowed;
    filter: grayscale(50%);
}

.mission-thumb {
    width: 120px;
    min-height: 80px;
    background-size: cover;
    background-position: center;
    position: relative;
}

.mission-thumb::after {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(90deg, transparent 50%, rgba(26, 26, 53, 0.9) 100%);
}

.mission-info {
    flex: 1;
    padding: 12px 15px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    gap: 4px;
}

.mission-title {
    font-size: 0.9em;
    /* 缂傗晛鐨€涙ぞ缍?*/
    font-weight: bold;
    color: #fff;
    margin-bottom: 4px;
    /* 閸忎浇锟介幑銏ｏ拷閺勫墽銇氱€瑰本鏆ｉ弽鍥拷 */
    white-space: normal;
    word-break: break-word;
    line-height: 1.3;
}

.mission-card.locked .mission-title::before {
    content: '棣冩晙 ';
}

.mission-tagline {
    font-size: 0.85em !important;
    color: #999 !important;
    line-height: 1.4 !important;
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
}

.mission-card.locked .mission-tagline {
    color: #666;
}

/* 闂傚懏鍎崇€规娊寮伴悢鍛娦?*/
.mission-difficulty {
    display: flex;
    gap: 2px;
    margin-top: 8px;
}

.star {
    color: #ffd700;
    font-size: 0.8em;
}

.star.empty {
    color: #444;
}

/* 閻樿埖鈧焦鐖ｇ粵锟?- 閺€閫涜礋鐞涘苯鍞撮弰鍓с仛闁灝鍘ら柌宥呭綌 */
.mission-status {
    display: inline-block;
    margin-left: 8px;
    padding: 3px 10px;
    border-radius: 12px;
    font-size: 0.75em;
    font-weight: bold;
    vertical-align: middle;
}

.mission-status.finished {
    background: rgba(0, 200, 100, 0.2);
    color: #00c864;
    border: 1px solid rgba(0, 200, 100, 0.3);
}

.mission-status.current {
    background: rgba(168, 85, 247, 0.2);
    color: #a855f7;
    border: 1px solid rgba(168, 85, 247, 0.3);
    animation: statusPulse 2s infinite;
}

.mission-status.locked {
    background: rgba(100, 100, 100, 0.2);
    color: #666;
    border: 1px solid rgba(100, 100, 100, 0.3);
}

@keyframes statusPulse {

    0%,
    100% {
        opacity: 1;
    }

    50% {
        opacity: 0.6;
    }
}

/* 闂佹彃绉甸弻濠冩媴閹捐崵宕ｉ柟绋匡拷閹革拷 */
.mission-action {
    display: flex;
    align-items: center;
    padding: 0 15px;
    background: rgba(168, 85, 247, 0.1);
    border-left: 1px solid rgba(168, 85, 247, 0.2);
}

.mission-action-btn {
    padding: 8px 15px;
    font-size: 0.85em;
    background: linear-gradient(145deg, #a855f7, #8b3fd1);
    border: none;
    border-radius: 20px;
    color: #fff;
    cursor: pointer;
    transition: all 0.3s;
    white-space: nowrap;
}

.mission-action-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 0 15px rgba(168, 85, 247, 0.5);
}

.mission-card.locked .mission-action {
    background: rgba(100, 100, 100, 0.1);
    border-left-color: rgba(100, 100, 100, 0.2);
}

.mission-card.locked .mission-action-btn {
    background: linear-gradient(145deg, #555, #444);
    cursor: not-allowed;
}

.mission-card.locked .mission-action-btn:hover {
    transform: none;
    box-shadow: none;
}

/* ========== 闁轰礁鎳嶇花銊ノ熼垾宕囩闁哄秴鍢茬槐锟?========== */

/* 闁轰礁鎳嶇花銊р偓鐢碉拷閻﹁棄锟介崱妯煎鐎碉拷?*/
/* 闁轰礁鎳嶇花銊р偓鐢碉拷閻︿粙宕犻崨甯嫹闁革綇鎷风槐娆撳触閿熺晫褰岀紓浣癸公缁憋拷 */
.story-dialog-wrapper {
    position: fixed;
    bottom: 10vh;
    left: 0;
    right: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    pointer-events: none;
}

/* 缂佹柨锟界划锟藉礌閸濆嫮鍘?- 閻忕偛鎳嶉懙鎴﹀及閸撗佷粵闁革负鍔岄敓鐣屾嫚濠靛浄鎷峰☉鎾筹攻閺岋拷 */
.story-portrait-area {
    position: relative;
    width: 100%;
    display: flex;
    justify-content: center;
    pointer-events: none;
    z-index: 1001;
    margin-bottom: -30px;
}

.story-portrait-area.hidden {
    display: none;
}

/* 缂佹柨锟界划锟藉炊閸撗冿拷 - 閻℃帒鎳庨妵鍥╀焊閸濆嫸鎷烽柡鍕⒔濠у倿寮伴崜褋浠涢柨娑樿嫰閻秹鎮抽弶瑁や海閻拷鐗愮€碉拷 */
.story-portrait {
    width: auto;
    height: 55vh;
    min-height: 400px;
    max-height: 600px;
    max-width: 95vw;
    object-fit: contain;
    filter: drop-shadow(0 0 50px rgba(0, 212, 255, 0.7)) drop-shadow(0 0 100px rgba(0, 212, 255, 0.3)) drop-shadow(0 15px 60px rgba(0, 0, 0, 0.9));
    animation: portraitFadeIn 0.5s ease-out;
}

.story-portrait.hidden {
    display: none;
}

@keyframes portraitFadeIn {
    from {
        opacity: 0;
        transform: translateY(30px) scale(0.9);
    }

    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

/* 閻庣數锟介惁钘夛拷閸℃鏁堕悗锟?*/
.story-dialog-content {
    position: relative;
    width: 100%;
    max-width: 900px;
    background: linear-gradient(180deg, rgba(10, 10, 20, 0.95) 0%, rgba(20, 20, 40, 0.98) 100%);
    padding: 25px 40px;
    border-top: 2px solid rgba(0, 212, 255, 0.3);
    border-radius: 15px 15px 0 0;
    min-height: 150px;
    cursor: pointer;
    animation: slideUp 0.3s ease-out;
    pointer-events: auto;
}

@keyframes slideUp {
    from {
        transform: translateY(100%);
        opacity: 0;
    }

    to {
        transform: translateY(0);
        opacity: 1;
    }
}

.story-dialog-speaker {
    font-size: 1.3em;
    font-weight: bold;
    margin-bottom: 15px;
    padding: 5px 15px;
    border-radius: 5px;
    display: inline-block;
}

.story-dialog-speaker.speaker-sys {
    color: #888;
    background: rgba(100, 100, 100, 0.2);
}

.story-dialog-speaker.speaker-plr {
    color: #4FC3F7;
    background: rgba(79, 195, 247, 0.15);
    border-left: 3px solid #4FC3F7;
}

.story-dialog-speaker.speaker-yi {
    color: #00FFFF;
    background: rgba(0, 255, 255, 0.15);
    border-left: 3px solid #00FFFF;
    text-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
}

.story-dialog-text {
    font-size: 1.2em;
    color: #e0e0e0;
    line-height: 1.8;
    margin-bottom: 15px;
    animation: textFade 0.3s ease-out;
}

@keyframes textFade {
    from {
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

.story-dialog-hint {
    position: absolute;
    bottom: 15px;
    right: 30px;
    color: #666;
    font-size: 0.9em;
    animation: blink 1.5s infinite;
}

/* 閻犲搫鐤囩换鍐偓鐢碉拷閻︿粙骞愭径鎰唉 */
.skip-dialog-btn {
    position: absolute;
    top: 15px;
    right: 30px;
    padding: 8px 20px;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 20px;
    color: #888;
    font-size: 0.9em;
    cursor: pointer;
    transition: all 0.3s;
    z-index: 10;
}

.skip-dialog-btn:hover {
    background: rgba(255, 100, 100, 0.2);
    border-color: rgba(255, 100, 100, 0.4);
    color: #ff6b6b;
}

@keyframes blink {

    0%,
    50%,
    100% {
        opacity: 1;
    }

    25%,
    75% {
        opacity: 0.3;
    }
}

/* 闁轰礁鎳嶇花銊ノ熼垾宕囩闁煎啿鏈▍娆戞啺閸℃瑦纾伴悘鐐插亰缁辨瑩宕ｉ敓瑙ｅ亾婢舵稓绀夐悹浣叉櫈閸庢寮查敓鑺ョ函缂佹劒绀侀崵锟芥晬?*/
body.story-mode::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.3);
    pointer-events: none;
    z-index: -1;
}

/* 闁轰礁鎳嶇花銊ノ熼垾宕囩濞戞挸锟藉▓锝夋寠韫囧海锟藉ù婊勭◥缁楀妫侀埀锟芥啺娴ｇ儤鐣盪I */
body.story-mode .game-stats,
body.story-mode .game-timer {
    opacity: 0.5;
}

@media (max-width: 650px) {
    #board {
        width: 95vw;
        height: 95vw;
        max-width: 500px;
        max-height: 500px;
    }

    h1 {
        font-size: 1.8em;
    }

    .player {
        padding: 8px 15px;
        font-size: 0.9em;
    }

    .btn {
        padding: 10px 18px;
        font-size: 14px;
    }

    .rps-content {
        min-width: auto;
        width: 95vw;
        padding: 20px;
    }

    .rps-game {
        flex-direction: column;
        gap: 15px;
    }

    .rps-btn {
        font-size: 2em;
        padding: 10px;
    }

    .countdown-number {
        font-size: 5em;
    }

    /* 闁轰礁鎳嶇花銊ノ熼垾宕囩缂佸锟芥慨鈺冪博閿熻В鍋撻崒鐐插赋 */
    .story-dialog-content {
        padding: 20px;
        min-height: 150px;
    }

    .story-dialog-text {
        font-size: 1em;
    }
}

/* ========== 閻犲鍟抽惁锟芥閵忊剝绶查柡宥呭槻缁憋拷 ========== */

.debug-panel {
    position: fixed;
    bottom: 20px;
    right: 20px;
    z-index: 2147483647;
    pointer-events: auto !important;
    isolation: isolate;
}

.debug-toggle {
    width: 50px;
    height: 50px;
    pointer-events: auto !important;
    position: relative;
    z-index: 2147483647;
    border-radius: 50%;
    background: linear-gradient(145deg, #ff6b35, #e55a2b);
    border: 2px solid #ffa07a;
    font-size: 1.5em;
    cursor: pointer;
    box-shadow: 0 4px 15px rgba(255, 107, 53, 0.4);
    transition: all 0.3s;
}

.debug-toggle:hover {
    transform: scale(1.1) rotate(15deg);
    box-shadow: 0 6px 25px rgba(255, 107, 53, 0.6);
}

.debug-toggle.active {
    background: linear-gradient(145deg, #00c853, #00a844);
    border-color: #69f0ae;
    box-shadow: 0 4px 15px rgba(0, 200, 83, 0.4);
}

.debug-menu {
    position: absolute;
    bottom: 60px;
    right: 0;
    width: 280px;
    background: linear-gradient(145deg, #2a2a4a, #1a1a3a);
    border-radius: 15px;
    padding: 20px;
    border: 2px solid rgba(255, 107, 53, 0.3);
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
    animation: debugMenuIn 0.3s ease-out;
}

@keyframes debugMenuIn {
    from {
        transform: translateY(20px) scale(0.9);
        opacity: 0;
    }

    to {
        transform: translateY(0) scale(1);
        opacity: 1;
    }
}

.debug-title {
    font-size: 1.2em;
    font-weight: bold;
    color: #ff6b35;
    text-align: center;
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 1px solid rgba(255, 107, 53, 0.3);
}

.debug-section {
    margin-bottom: 15px;
}

.debug-label {
    display: block;
    font-size: 0.9em;
    color: #888;
    margin-bottom: 10px;
}

.debug-buttons {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 8px;
}

.debug-btn {
    padding: 8px 12px;
    font-size: 0.85em;
    font-weight: bold;
    color: #fff;
    background: linear-gradient(145deg, #3a3a6a, #2a2a5a);
    border: 1px solid rgba(0, 212, 255, 0.3);
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s;
}

.debug-btn:hover {
    background: linear-gradient(145deg, #4a4a7a, #3a3a6a);
    border-color: #00d4ff;
    box-shadow: 0 0 10px rgba(0, 212, 255, 0.3);
    transform: translateY(-2px);
}

.debug-btn.full {
    grid-column: span 4;
    padding: 12px;
    font-size: 0.95em;
}

.debug-btn.full:first-of-type {
    background: linear-gradient(145deg, #00c853, #00a844);
    border-color: rgba(0, 200, 83, 0.5);
}

.debug-btn.full:first-of-type:hover {
    box-shadow: 0 0 15px rgba(0, 200, 83, 0.4);
}

.debug-btn.danger {
    background: linear-gradient(145deg, #d32f2f, #b71c1c);
    border-color: rgba(255, 100, 100, 0.5);
}

.debug-btn.danger:hover {
    box-shadow: 0 0 15px rgba(255, 100, 100, 0.4);
}

.debug-info {
    margin-top: 10px;
    padding: 10px;
    background: rgba(0, 0, 0, 0.2);
    border-radius: 8px;
    font-size: 0.85em;
    color: #888;
    text-align: center;
}

.debug-menu.hidden {
    display: none;
}

/* ========== AI闂呮儳瀹抽柅澶嬪瀵湱鐛?========== */

.difficulty-content {
    min-width: 360px;
    max-width: 420px;
    text-align: center;
    padding: 30px 25px;
}

.difficulty-content h2 {
    color: #fff;
    font-size: 1.4em;
    margin-bottom: 25px;
}

.difficulty-options {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 12px;
    margin-bottom: 25px;
}

.difficulty-btn {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px 10px;
    background: rgba(255, 255, 255, 0.03);
    border: 2px solid rgba(255, 255, 255, 0.08);
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.difficulty-btn:hover {
    background: rgba(255, 255, 255, 0.06);
    border-color: rgba(0, 212, 255, 0.3);
    transform: translateY(-3px);
}

.difficulty-btn.selected {
    background: rgba(0, 212, 255, 0.1);
    border-color: rgba(0, 212, 255, 0.5);
    box-shadow: 0 0 20px rgba(0, 212, 255, 0.15);
}

.diff-icon {
    font-size: 2em;
    margin-bottom: 10px;
}

.diff-name {
    color: #fff;
    font-size: 1.1em;
    font-weight: 600;
    margin-bottom: 6px;
}

.diff-desc {
    color: rgba(255, 255, 255, 0.5);
    font-size: 0.75em;
}

.difficulty-actions {
    display: flex;
    gap: 12px;
}

.difficulty-start-btn {
    flex: 2;
    padding: 12px 20px;
    background: linear-gradient(145deg, #00d4ff, #0099cc);
    border: none;
    border-radius: 25px;
    color: #fff;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
}

.difficulty-start-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 20px rgba(0, 212, 255, 0.4);
}

.difficulty-cancel-btn {
    flex: 1;
    padding: 12px 20px;
    background: transparent;
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 25px;
    color: rgba(255, 255, 255, 0.6);
    cursor: pointer;
    transition: all 0.2s;
}

.difficulty-cancel-btn:hover {
    border-color: rgba(255, 255, 255, 0.4);
    color: rgba(255, 255, 255, 0.8);
}

/* ========== 娴兼﹢娉ゅù锟藉З閸滄牕鏆嬮幐澶愭尦 ========== */

.coffee-float-btn {
    position: fixed;
    bottom: 30px;
    right: 30px;
    z-index: 1000;

    /* 姒涙锟介弨鎯版崳閻樿埖鈧拷 - 鐏忓繐娓鹃悙锟?*/
    width: 48px;
    height: 48px;
    border-radius: 50%;

    /* 閻滆崵鎷戠拹銊﹀妳 */
    background: rgba(20, 20, 30, 0.6);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.08);

    /* 鐢啫鐪?*/
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0;
    overflow: hidden;
    white-space: nowrap;

    /* 閸忓鐖?*/
    cursor: pointer;

    /* 鏉╁洦娴崝銊ф暰 */
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);

    /* 瀵帮拷锟介崨鐓庢儧閸忓妾?*/
    box-shadow:
        0 4px 20px rgba(0, 0, 0, 0.3),
        0 0 0 1px rgba(167, 139, 250, 0.1);
}

/* 閸涚厧鎯涢崝銊ф暰 */
@keyframes coffeeBreath {

    0%,
    100% {
        box-shadow:
            0 4px 20px rgba(0, 0, 0, 0.3),
            0 0 15px rgba(167, 139, 250, 0.15);
    }

    50% {
        box-shadow:
            0 4px 25px rgba(0, 0, 0, 0.4),
            0 0 25px rgba(167, 139, 250, 0.25);
    }
}

.coffee-float-btn {
    animation: coffeeBreath 4s ease-in-out infinite;
}

.coffee-icon {
    font-size: 1.4em;
    opacity: 0.7;
    transition: all 0.3s ease;
    flex-shrink: 0;
}

.coffee-text {
    font-size: 0;
    opacity: 0;
    color: rgba(255, 255, 255, 0.8);
    font-weight: 500;
    letter-spacing: 0.5px;
    transition: all 0.3s ease 0.1s;
    margin-left: 0;
}

/* 閹拷璇炵仦鏇炵磻閺佸牊鐏?*/
.coffee-float-btn:hover {
    width: 160px;
    border-radius: 24px;
    padding: 0 18px;
    background: rgba(30, 30, 50, 0.85);
    border-color: rgba(167, 139, 250, 0.3);
    animation: none;
    box-shadow:
        0 6px 30px rgba(0, 0, 0, 0.4),
        0 0 30px rgba(167, 139, 250, 0.2);
}

.coffee-float-btn:hover .coffee-icon {
    opacity: 1;
    transform: rotate(-10deg) scale(1.1);
}

.coffee-float-btn:hover .coffee-text {
    font-size: 0.85em;
    opacity: 1;
    margin-left: 8px;
}

/* 閻愮懓鍤弫鍫熺亯 */
.coffee-float-btn:active {
    transform: scale(0.95);
}

/* 缁夎濮╃粩锟解偓鍌炲帳 */
@media screen and (max-width: 600px) {
    .coffee-float-btn {
        bottom: 80px;
        /* 闁灝绱戞惔鏇㈠劥閹貉冨煑閺嶏拷 */
        right: 15px;
        width: 42px;
        height: 42px;
    }

    .coffee-float-btn:hover {
        width: 140px;
        padding: 0 14px;
    }

    .coffee-icon {
        font-size: 1.2em;
    }

    .coffee-float-btn:hover .coffee-text {
        font-size: 0.75em;
    }
}

/* ========== 閹规劘绂掑鍦崶閺嶅嘲绱?========== */

.donate-content-new {
    min-width: 360px;
    max-width: 420px;
    padding: 30px 25px;
    text-align: center;
    position: relative;
}

.donate-close-btn {
    position: absolute;
    top: 15px;
    right: 15px;
    width: 32px;
    height: 32px;
    border: none;
    background: rgba(255, 255, 255, 0.05);
    color: rgba(255, 255, 255, 0.5);
    font-size: 1.5em;
    cursor: pointer;
    border-radius: 50%;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
}

.donate-close-btn:hover {
    background: rgba(255, 255, 255, 0.1);
    color: rgba(255, 255, 255, 0.8);
}

.donate-header {
    margin-bottom: 25px;
}

.coffee-steam {
    font-size: 3em;
    margin-bottom: 10px;
    animation: steamFloat 3s ease-in-out infinite;
}

@keyframes steamFloat {

    0%,
    100% {
        transform: translateY(0) rotate(-3deg);
        opacity: 0.9;
    }

    50% {
        transform: translateY(-8px) rotate(3deg);
        opacity: 1;
    }
}

.donate-header h2 {
    color: #fff;
    font-size: 1.6em;
    font-weight: 600;
    margin-bottom: 12px;
    letter-spacing: 1px;
}

.donate-subtitle {
    color: rgba(255, 255, 255, 0.6);
    font-size: 0.95em;
    line-height: 1.6;
}

.coffee-menu {
    margin-bottom: 25px;
}

.menu-hint {
    color: rgba(255, 255, 255, 0.5);
    font-size: 0.85em;
    margin-bottom: 15px;
}

.coffee-options {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 10px;
    margin-bottom: 18px;
}

.coffee-option {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 15px 8px;
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.08);
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.coffee-option:hover {
    background: rgba(255, 255, 255, 0.06);
    border-color: rgba(167, 139, 250, 0.3);
    transform: translateY(-2px);
}

.coffee-option.selected {
    background: rgba(167, 139, 250, 0.1);
    border-color: rgba(167, 139, 250, 0.5);
    box-shadow: 0 0 20px rgba(167, 139, 250, 0.15);
}

.option-icon {
    font-size: 1.5em;
    margin-bottom: 6px;
}

.option-name {
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.8em;
    margin-bottom: 4px;
}

.coffee-option.selected .option-name {
    color: rgba(255, 255, 255, 0.9);
}

.option-price {
    color: #a78bfa;
    font-size: 0.9em;
    font-weight: 600;
}

.custom-amount {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    color: rgba(255, 255, 255, 0.5);
    font-size: 0.85em;
}

.custom-amount input {
    width: 80px;
    padding: 8px 12px;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    color: #fff;
    font-size: 0.95em;
    text-align: center;
    outline: none;
    transition: all 0.2s;
}

.custom-amount input:focus {
    border-color: rgba(167, 139, 250, 0.4);
    background: rgba(255, 255, 255, 0.08);
}

.custom-amount input::placeholder {
    color: rgba(255, 255, 255, 0.3);
}

.donate-actions {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-bottom: 15px;
}

.donate-confirm-btn {
    padding: 14px 30px;
    background: linear-gradient(135deg, #d4a574, #c08552);
    border: none;
    border-radius: 25px;
    color: #fff;
    font-size: 1.05em;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s;
    box-shadow: 0 4px 15px rgba(208, 165, 116, 0.25);
}

.donate-confirm-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 25px rgba(208, 165, 116, 0.35);
}

.donate-skip-btn {
    padding: 10px 20px;
    background: transparent;
    border: none;
    color: rgba(255, 255, 255, 0.4);
    font-size: 0.9em;
    cursor: pointer;
    transition: color 0.2s;
}

.donate-skip-btn:hover {
    color: rgba(255, 255, 255, 0.6);
}

.donate-footer {
    color: rgba(255, 255, 255, 0.35);
    font-size: 0.75em;
    margin: 0;
}

/* 缁夎濮╃粩锟解偓鍌炲帳 */
@media screen and (max-width: 500px) {
    .donate-content-new {
        min-width: auto;
        width: 95%;
        padding: 25px 18px;
    }

    .coffee-options {
        grid-template-columns: repeat(2, 1fr);
    }

    .donate-header h2 {
        font-size: 1.4em;
    }

    .donate-subtitle {
        font-size: 0.9em;
    }
}

/* ========== 瀵帮拷淇婃禍宀€娣惍浣歌剨缁愭鐗卞锟?========== */

.wechat-content-new {
    min-width: 320px;
    max-width: 380px;
    padding: 30px 25px;
    text-align: center;
    position: relative;
}

.wechat-close-btn {
    position: absolute;
    top: 15px;
    right: 15px;
    width: 32px;
    height: 32px;
    border: none;
    background: rgba(255, 255, 255, 0.05);
    color: rgba(255, 255, 255, 0.5);
    font-size: 1.5em;
    cursor: pointer;
    border-radius: 50%;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
}

.wechat-close-btn:hover {
    background: rgba(255, 255, 255, 0.1);
    color: rgba(255, 255, 255, 0.8);
}

.wechat-header-new {
    margin-bottom: 20px;
}

.thank-icon {
    font-size: 2.5em;
    display: block;
    margin-bottom: 10px;
    animation: gentlePulse 2s ease-in-out infinite;
}

@keyframes gentlePulse {

    0%,
    100% {
        transform: scale(1);
        opacity: 0.9;
    }

    50% {
        transform: scale(1.05);
        opacity: 1;
    }
}

.wechat-header-new h2 {
    color: #fff;
    font-size: 1.4em;
    font-weight: 500;
    letter-spacing: 1px;
}

.wechat-qr-card {
    background: #fff;
    padding: 20px;
    border-radius: 16px;
    display: inline-block;
    margin-bottom: 20px;
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
}

.qr-image-new {
    width: 180px;
    height: 180px;
    object-fit: contain;
    border-radius: 8px;
    display: block;
    margin-bottom: 10px;
}

.scan-hint {
    color: #666;
    font-size: 0.85em;
    margin: 0;
}

.wechat-author {
    margin-bottom: 20px;
}

.wechat-author p {
    color: rgba(255, 255, 255, 0.5);
    font-size: 0.9em;
    margin: 5px 0;
}

.author-name-new {
    color: rgba(255, 255, 255, 0.8);
    font-weight: 500;
}

.wechat-id-new {
    color: rgba(255, 255, 255, 0.4);
    font-size: 0.85em;
}

.wechat-done-btn {
    padding: 12px 50px;
    background: linear-gradient(135deg, #d4a574, #c08552);
    border: none;
    border-radius: 25px;
    color: #fff;
    font-size: 1em;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s;
    margin-bottom: 15px;
    box-shadow: 0 4px 15px rgba(208, 165, 116, 0.25);
}

.wechat-done-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 25px rgba(208, 165, 116, 0.35);
}

.wechat-footer {
    color: rgba(255, 255, 255, 0.35);
    font-size: 0.75em;
    margin: 0;
}

/* 缁夎濮╃粩锟解偓鍌炲帳 */
@media screen and (max-width: 400px) {
    .wechat-content-new {
        min-width: auto;
        width: 95%;
        padding: 25px 18px;
    }

    .qr-image-new {
        width: 160px;
        height: 160px;
    }
}

.wechat-tip {
    color: #888;
    font-size: 0.95em;
    margin: 15px 0;
    padding: 10px;
    background: rgba(255, 215, 0, 0.1);
    border-radius: 8px;
    border: 1px dashed rgba(255, 215, 0, 0.3);
}

.wechat-ok-btn {
    padding: 15px 60px;
    font-size: 1.2em;
    background: linear-gradient(145deg, #00c853, #00a844);
    border: 2px solid #69f0ae;
    border-radius: 30px;
    color: #fff;
    cursor: pointer;
    transition: all 0.3s;
    box-shadow: 0 4px 20px rgba(0, 200, 83, 0.4);
    margin-top: 10px;
}

.wechat-ok-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 6px 30px rgba(0, 200, 83, 0.6);
}

/* ========== 濞寸姾锟芥慨鐔虹不閳э拷骞庨妷鈺傛〃闁哄瀵ч悧鍗烇拷?========== */

.mission-brief-content {
    min-width: 420px;
    max-width: 520px;
    text-align: left;
}

.mission-brief-header {
    text-align: center;
    margin-bottom: 25px;
    padding-bottom: 15px;
    border-bottom: 1px solid rgba(168, 85, 247, 0.3);
}

.mission-brief-header h2 {
    color: #a855f7;
    font-size: 1.5em;
    margin-bottom: 8px;
}

.mission-subtitle {
    color: #888;
    font-size: 1em;
    margin: 0;
}

.mission-brief-body {
    margin-bottom: 25px;
}

.brief-section {
    background: rgba(255, 255, 255, 0.03);
    padding: 15px 20px;
    border-radius: 10px;
    margin-bottom: 15px;
    border-left: 3px solid #a855f7;
}

.brief-section h3 {
    color: #a855f7;
    font-size: 1.1em;
    margin-bottom: 10px;
}

.brief-section p {
    color: #ccc;
    font-size: 0.95em;
    line-height: 1.6;
    margin: 0;
}

.mission-brief-buttons {
    display: flex;
    gap: 15px;
    justify-content: center;
}

.mission-btn {
    padding: 12px 30px;
    font-size: 1em;
    border-radius: 25px;
    transition: all 0.3s;
}

.mission-btn.primary {
    background: linear-gradient(145deg, #a855f7, #8b3fd1);
    border: 2px solid #c084fc;
    box-shadow: 0 4px 20px rgba(168, 85, 247, 0.4);
}

.mission-btn.primary:hover {
    transform: scale(1.05);
    box-shadow: 0 6px 30px rgba(168, 85, 247, 0.6);
}

.mission-btn.secondary {
    background: linear-gradient(145deg, #4a4a6a, #3a3a5a);
    border: 2px solid #5a5a7a;
    color: #aaa;
}

.mission-btn.secondary:hover {
    background: linear-gradient(145deg, #5a5a7a, #4a4a6a);
    color: #ccc;
}

/* ========== 婵炲牆鍚€缂嶅懘寮茬€ｏ拷纾抽梻鍫涘灪濠㈡﹢寮藉畡鎵 ========== */

.rank-up-content {
    min-width: 380px;
    max-width: 450px;
    text-align: center;
}

.rank-up-icon {
    font-size: 4em;
    margin-bottom: 15px;
    animation: trophyBounce 1s infinite;
}

@keyframes trophyBounce {

    0%,
    100% {
        transform: translateY(0) scale(1);
    }

    50% {
        transform: translateY(-15px) scale(1.1);
    }
}

.rank-up-content h2 {
    color: #ffd700;
    font-size: 1.8em;
    margin-bottom: 20px;
    text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
}

.rank-up-title {
    font-size: 2em;
    font-weight: bold;
    color: #a855f7;
    margin-bottom: 15px;
    padding: 15px 30px;
    background: linear-gradient(145deg, rgba(168, 85, 247, 0.2), rgba(168, 85, 247, 0.1));
    border-radius: 15px;
    border: 2px solid rgba(168, 85, 247, 0.4);
    text-shadow: 0 0 15px rgba(168, 85, 247, 0.5);
    animation: rankGlow 2s infinite;
}

@keyframes rankGlow {

    0%,
    100% {
        box-shadow: 0 0 20px rgba(168, 85, 247, 0.3);
    }

    50% {
        box-shadow: 0 0 40px rgba(168, 85, 247, 0.6);
    }
}

.rank-up-desc {
    color: #ccc;
    font-size: 1em;
    line-height: 1.6;
    margin-bottom: 25px;
}

.rank-up-btn {
    padding: 15px 50px;
    font-size: 1.1em;
    background: linear-gradient(145deg, #ffd700, #ffaa00);
    border: 2px solid #ffcc00;
    border-radius: 30px;
    color: #1a1a2e;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s;
    box-shadow: 0 4px 20px rgba(255, 215, 0, 0.4);
}

.rank-up-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 6px 30px rgba(255, 215, 0, 0.6);
}

/* ========== 闁圭粯鍔楅妵姝峯ast闁哄秴鍢茬槐锟?========== */

.toast {
    position: fixed;
    top: 100px;
    left: 50%;
    transform: translateX(-50%);
    background: linear-gradient(145deg, #ff6b35, #e55a2b);
    color: #fff;
    padding: 15px 30px;
    border-radius: 30px;
    font-size: 1em;
    font-weight: bold;
    box-shadow: 0 5px 25px rgba(255, 107, 53, 0.5);
    z-index: 2000;
    animation: toastIn 0.3s ease-out;
    display: flex;
    align-items: center;
    gap: 10px;
}

@keyframes toastIn {
    from {
        transform: translateX(-50%) translateY(-30px);
        opacity: 0;
    }

    to {
        transform: translateX(-50%) translateY(0);
        opacity: 1;
    }
}

.toast-icon {
    font-size: 1.3em;
}

.toast-text {
    max-width: 400px;
}

.toast.hidden {
    display: none;
}

/* ========== 闁告ê妫楄ぐ鑸电鐎ｏ拷鐭濋柛蹇嬪劚瑜版盯骞愭径鎰唉闁哄秴鍢茬槐锟?========== */

.history-mode-buttons {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.history-btn {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 18px 20px;
    text-align: left;
    background: linear-gradient(145deg, #2a3a4a, #1a2a3a);
    border: 2px solid transparent;
    transition: all 0.3s;
}

.history-btn:hover {
    border-color: #ffd700;
    box-shadow: 0 0 25px rgba(255, 215, 0, 0.3);
    transform: translateX(5px);
}

/* ========== 闁告ê妫楄ぐ鑸电鐎ｏ拷鐭濋梻鍫涘灪濠㈡﹢寮藉畡鎵 ========== */

.history-panel {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, #0a0a15 0%, #1a1a2e 50%, #0f0f1a 100%);
    z-index: 2000;
    overflow-y: auto;
    animation: historyFadeIn 0.5s ease-out;
}

@keyframes historyFadeIn {
    from {
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

.history-header {
    text-align: center;
    padding: 60px 20px 40px;
    background: linear-gradient(180deg, rgba(255, 215, 0, 0.1) 0%, transparent 100%);
    border-bottom: 1px solid rgba(255, 215, 0, 0.2);
}

.history-header h1 {
    font-size: 2.5em;
    color: #ffd700;
    text-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
    margin-bottom: 15px;
    letter-spacing: 3px;
}

.history-subtitle {
    font-size: 1.2em;
    color: #888;
    margin: 0;
    letter-spacing: 5px;
}

.history-content {
    max-width: 900px;
    background: linear-gradient(180deg, rgba(30, 30, 50, 0.95) 0%, rgba(20, 20, 35, 0.98) 100%);
    border-radius: 20px;
    padding: 40px 50px 120px;
    margin: 20px auto;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
}

/* 闁哄倸娲ㄩ悵鐑藉箳閹烘柨锟藉ù鍏济€碉拷 */
.history-content h1 {
    color: #ffd700;
    font-size: 2em;
    text-align: center;
    margin-bottom: 30px;
    text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
}

.history-content h2 {
    color: #ffd700;
    font-size: 1.5em;
    margin-top: 40px;
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 2px solid rgba(255, 215, 0, 0.3);
}

.history-content h2 small {
    display: block;
    font-size: 0.7em;
    color: #00d4ff;
    margin-top: 5px;
}

.history-content h3 {
    color: #00d4ff;
    font-size: 1.2em;
    margin-top: 25px;
    margin-bottom: 15px;
}

.history-content p {
    color: #e8e8e8;
    font-size: 1.1em;
    line-height: 2;
    margin-bottom: 18px;
    text-align: justify;
}

.history-content p.intro {
    font-size: 1.2em;
    color: #ffd700;
    font-style: italic;
    text-align: center;
    margin-bottom: 30px;
}

.history-content p.highlight {
    background: linear-gradient(145deg, rgba(255, 215, 0, 0.15), rgba(255, 215, 0, 0.05));
    padding: 15px 20px;
    border-radius: 10px;
    border-left: 4px solid #ffd700;
    color: #fff;
    font-weight: 500;
}

.history-content p.ending {
    font-size: 1.3em;
    color: #ffd700;
    text-align: center;
    margin-top: 40px;
    font-weight: bold;
}

.history-content strong {
    color: #ffd700;
    font-weight: bold;
}

.history-content ul {
    margin: 20px 0;
    padding-left: 30px;
}

.history-content li {
    color: #e0e0e0;
    font-size: 1.05em;
    line-height: 1.9;
    margin-bottom: 12px;
    position: relative;
}

.history-content li::marker {
    color: #ffd700;
}

/* 闁告帒妫濆▓褏鐥?*/
.history-content hr {
    border: none;
    height: 2px;
    background: linear-gradient(90deg, transparent, rgba(255, 215, 0, 0.4), transparent);
    margin: 40px 0;
    margin: 0 auto;
    padding: 40px 30px 100px;
}

/* 闁告ê妫楄ぐ鍓佺博閻樺搫螡闁哄秴鍢茬槐锟?*/
.history-chapter {
    margin-bottom: 60px;
    animation: chapterFadeIn 0.6s ease-out;
    animation-fill-mode: both;
}

.history-chapter:nth-child(1) {
    animation-delay: 0.1s;
}

.history-chapter:nth-child(2) {
    animation-delay: 0.2s;
}

.history-chapter:nth-child(3) {
    animation-delay: 0.3s;
}

.history-chapter:nth-child(4) {
    animation-delay: 0.4s;
}

.history-chapter:nth-child(5) {
    animation-delay: 0.5s;
}

.history-chapter:nth-child(6) {
    animation-delay: 0.6s;
}

.history-chapter:nth-child(7) {
    animation-delay: 0.7s;
}

.history-chapter:nth-child(8) {
    animation-delay: 0.8s;
}

@keyframes chapterFadeIn {
    from {
        opacity: 0;
        transform: translateY(30px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.chapter-header {
    display: flex;
    align-items: center;
    gap: 15px;
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 2px solid rgba(255, 215, 0, 0.3);
}

.chapter-icon {
    font-size: 2.5em;
    width: 60px;
    height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: linear-gradient(145deg, rgba(255, 215, 0, 0.2), rgba(255, 215, 0, 0.1));
    border-radius: 15px;
    border: 1px solid rgba(255, 215, 0, 0.3);
}

.chapter-title-wrap {
    flex: 1;
}

.chapter-era {
    font-size: 0.9em;
    color: #ffd700;
    letter-spacing: 2px;
    margin-bottom: 5px;
}

.chapter-title {
    font-size: 1.5em;
    color: #fff;
    margin: 0;
    text-shadow: 0 0 10px rgba(255, 255, 255, 0.2);
}

.chapter-body {
    padding-left: 20px;
    border-left: 3px solid rgba(255, 215, 0, 0.2);
}

.chapter-body p {
    color: #ccc;
    font-size: 1.05em;
    line-height: 1.9;
    margin-bottom: 15px;
    text-align: justify;
}

.chapter-body p:last-child {
    margin-bottom: 0;
}

/* 闁稿繑濞婇弫锟界┍閳╁啩绱栧Δ鍌浢肩€碉拷 */
.history-highlight {
    color: #ffd700;
    font-weight: bold;
}

.history-emphasis {
    color: #00d4ff;
    font-style: italic;
}

/* 鐎碉拷娲滈弫銈夊锤濡や胶澹夌€碉拷?*/
.history-quote {
    background: linear-gradient(145deg, rgba(255, 215, 0, 0.1), rgba(255, 215, 0, 0.05));
    padding: 20px 25px;
    border-radius: 10px;
    border-left: 4px solid #ffd700;
    margin: 20px 0;
    font-style: italic;
    color: #e0e0e0;
}

.history-quote cite {
    display: block;
    margin-top: 10px;
    color: #888;
    font-size: 0.9em;
    text-align: right;
}

/* 闁哄啫鐖煎Λ璺ㄧ棯閼筹拷螡闁伙拷?*/
.timeline-point {
    display: inline-block;
    background: linear-gradient(145deg, #ffd700, #ffaa00);
    color: #1a1a2e;
    padding: 3px 12px;
    border-radius: 15px;
    font-size: 0.85em;
    font-weight: bold;
    margin-right: 10px;
}

/* 闁告ê妫楄ぐ鑸点亜娴ｅ啫澹?*/
.history-footer {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 20px;
    background: linear-gradient(0deg, rgba(10, 10, 21, 0.98) 0%, rgba(10, 10, 21, 0.9) 80%, transparent 100%);
    text-align: center;
}

.history-close-btn {
    padding: 15px 40px;
    font-size: 1.1em;
    background: linear-gradient(145deg, #ffd700, #ffaa00);
    border: 2px solid #ffcc00;
    border-radius: 30px;
    color: #1a1a2e;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s;
    box-shadow: 0 4px 20px rgba(255, 215, 0, 0.4);
}

.history-close-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 6px 30px rgba(255, 215, 0, 0.6);
}

/* 缂佸锟芥慨鈺冪博閿熻В鍋撻崒鐐插赋 */
@media (max-width: 650px) {
    .history-header h1 {
        font-size: 1.6em;
        letter-spacing: 1px;
    }

    .history-subtitle {
        font-size: 0.95em;
        letter-spacing: 2px;
    }

    .history-content {
        padding: 30px 20px 120px;
    }

    .chapter-header {
        flex-direction: column;
        text-align: center;
    }

    .chapter-title {
        font-size: 1.2em;
    }

    .chapter-body {
        padding-left: 15px;
    }

    .chapter-body p {
        font-size: 0.95em;
    }
}

/* ========== Toast閻庡湱鎳撳▍鎺楀冀瀹勬壆纭€ ========== */

#toast-container {
    position: fixed;
    top: 80px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 3000;
    display: flex;
    flex-direction: column;
    gap: 10px;
    pointer-events: none;
}

#toast-container .toast {
    position: relative;
    top: 0;
    left: 0;
    transform: translateY(-20px);
    opacity: 0;
    transition: all 0.3s ease;
    pointer-events: auto;
    padding: 12px 25px;
    border-radius: 25px;
    font-size: 1em;
    font-weight: bold;
    box-shadow: 0 5px 25px rgba(0, 0, 0, 0.4);
    max-width: 500px;
    text-align: center;
}

#toast-container .toast.show {
    transform: translateY(0);
    opacity: 1;
}

#toast-container .toast-info {
    background: linear-gradient(145deg, #00d4ff, #00a8cc);
    color: #fff;
}

#toast-container .toast-warning {
    background: linear-gradient(145deg, #ff9800, #e68a00);
    color: #fff;
    border: 2px solid #ffcc80;
}

#toast-container .toast-error {
    background: linear-gradient(145deg, #f44336, #d32f2f);
    color: #fff;
    border: 2px solid #ff8a80;
}

#toast-container .toast-success {
    background: linear-gradient(145deg, #4caf50, #388e3c);
    color: #fff;
    border: 2px solid #a5d6a7;
}

/* ========== 缂佸倷鐒︽晶婊堝极濞嗗骏鎷风€碉拷婀遍悰銉╁冀瀹勬壆纭€ ========== */

.forbidden-modal .modal-content {
    min-width: 400px;
    max-width: 500px;
}

.forbidden-tutorial-content {
    text-align: center;
}

.forbidden-icon {
    font-size: 4em;
    margin-bottom: 15px;
}

.forbidden-title {
    color: #ff9800;
    font-size: 1.6em;
    margin-bottom: 20px;
    text-shadow: 0 0 15px rgba(255, 152, 0, 0.5);
}

.forbidden-body {
    text-align: left;
    background: rgba(255, 152, 0, 0.1);
    padding: 20px;
    border-radius: 10px;
    border-left: 4px solid #ff9800;
    margin-bottom: 20px;
}

.forbidden-body p {
    color: #e0e0e0;
    font-size: 1em;
    line-height: 1.8;
    margin-bottom: 10px;
}

.forbidden-body p:last-child {
    margin-bottom: 0;
}

.forbidden-point-info {
    color: #888;
    font-size: 0.9em;
    margin-bottom: 20px;
    padding: 8px 15px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 20px;
    display: inline-block;
}

.forbidden-confirm-btn {
    padding: 15px 40px;
    font-size: 1.1em;
    background: linear-gradient(145deg, #ff9800, #e68a00);
    border: 2px solid #ffcc80;
    border-radius: 30px;
    color: #fff;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s;
    box-shadow: 0 4px 20px rgba(255, 152, 0, 0.4);
}

.forbidden-confirm-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 6px 30px rgba(255, 152, 0, 0.6);
}

/* ========== 缂佸倷鐒︽晶婊堝礆閵堝牏锟介梻鍫涘灪濠㈡﹢寮藉畡鎵 ========== */

.forbidden-lose-content {
    text-align: center;
}

.forbidden-level-name {
    color: #888;
    font-size: 1em;
    margin-bottom: 10px;
}

.forbidden-lose-content .forbidden-title {
    color: #f44336;
    text-shadow: 0 0 15px rgba(244, 67, 54, 0.5);
}

.forbidden-reason {
    text-align: left;
    background: rgba(244, 67, 54, 0.1);
    padding: 20px;
    border-radius: 10px;
    border-left: 4px solid #f44336;
    margin-bottom: 15px;
}

.forbidden-reason p {
    color: #e0e0e0;
    font-size: 1em;
    line-height: 1.8;
    margin-bottom: 8px;
}

.forbidden-reason p:last-child {
    margin-bottom: 0;
}

.forbidden-extra {
    margin-bottom: 15px;
}

.forbidden-extra .extra-line {
    color: #ff9800;
    font-style: italic;
    font-size: 0.95em;
    padding: 10px 15px;
    background: rgba(255, 152, 0, 0.1);
    border-radius: 8px;
    margin: 0;
}

.forbidden-actions {
    display: flex;
    gap: 15px;
    justify-content: center;
    margin-top: 20px;
}

.forbidden-retry-btn {
    padding: 12px 30px;
    font-size: 1em;
    background: linear-gradient(145deg, #4caf50, #388e3c);
    border: 2px solid #a5d6a7;
    border-radius: 25px;
    color: #fff;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s;
    box-shadow: 0 4px 15px rgba(76, 175, 80, 0.4);
}

.forbidden-retry-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 6px 25px rgba(76, 175, 80, 0.6);
}

.forbidden-menu-btn {
    padding: 12px 30px;
    font-size: 1em;
    background: linear-gradient(145deg, #4a4a6a, #3a3a5a);
    border: 2px solid #5a5a7a;
    border-radius: 25px;
    color: #aaa;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s;
}

.forbidden-menu-btn:hover {
    background: linear-gradient(145deg, #5a5a7a, #4a4a6a);
    color: #ccc;
}

/* ========== 闁轰礁鎳嶇花銊ノ熼垾宕囩HUD闁哄秴鍢茬槐锟?- 闁哄倿锟界粭渚€寮借箛鎾剁閻拷鍟惇锟?========== */

.story-hud {
    background: linear-gradient(145deg, rgba(20, 20, 40, 0.95), rgba(15, 15, 30, 0.98));
    border: 1px solid rgba(168, 85, 247, 0.3);
    border-radius: 15px;
    padding: 15px 20px;
    margin-bottom: 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 20px;
    box-shadow: 0 5px 25px rgba(0, 0, 0, 0.3), inset 0 0 20px rgba(168, 85, 247, 0.05);
}

/* 鐎归潻缂氶弲鍫曟晬濮橈拷褰犻柛妞烩偓韫箚闁癸拷?*/
.story-hud-left {
    flex: 0 0 auto;
    text-align: left;
    min-width: 180px;
}

.story-hud-title {
    font-size: 1.2em;
    font-weight: bold;
    color: #a855f7;
    margin-bottom: 4px;
    text-shadow: 0 0 10px rgba(168, 85, 247, 0.5);
}

.story-hud-subtitle {
    font-size: 0.85em;
    color: #888;
    letter-spacing: 2px;
}

/* 濞戞搫鎷峰Λ鍧楁晬濮樼鎷烽柛鎺撶懄閻栵絿绮?*/
.story-hud-center {
    flex: 1;
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 8px;
}

.rule-tag {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 5px 12px;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 20px;
    font-size: 0.8em;
    color: #ccc;
    white-space: nowrap;
    transition: all 0.3s;
}

.rule-tag .tag-icon {
    font-size: 1em;
}

/* 缂佸倷鐒︽晶婊勭▔閵夛妇澹愭俊锟解偓宕囩闁哄秴娲ㄩ敓浠嬫偋鐟欏嫮鏆曢柡宥呭槻缁憋拷 */
.rule-tag.tag-forbidden-strict {
    background: rgba(244, 67, 54, 0.15);
    border-color: rgba(244, 67, 54, 0.4);
    color: #ff6b6b;
}

/* 缂佸倷鐒︽晶婊堝极濞嗗骏鎷锋俊锟解偓宕囩闁哄秴娲ㄩ敓锟?*/
.rule-tag.tag-forbidden-teaching {
    background: rgba(255, 152, 0, 0.15);
    border-color: rgba(255, 152, 0, 0.4);
    color: #ffb74d;
}

/* 閻犱讲鍓濆鍌毼熼垾宕囩闁哄秴娲ㄩ敓锟?*/
.rule-tag.tag-time-pressure {
    background: rgba(255, 215, 0, 0.15);
    border-color: rgba(255, 215, 0, 0.4);
    color: #ffd700;
}

/* 闁瑰灈鍋撻柤瀹犲Г閻栵絿绮?*/
.rule-tag.tag-skill {
    background: rgba(0, 212, 255, 0.15);
    border-color: rgba(0, 212, 255, 0.4);
    color: #00d4ff;
}

/* 闁告瑥鍘栭弲鍫曟晬濮樼鎷烽柡鍐煐濡绮?*/
.story-hud-right {
    flex: 0 0 auto;
    text-align: right;
    min-width: 150px;
}

.timer-main {
    font-size: 1.4em;
    font-weight: bold;
    color: #ffd700;
    text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
    font-family: 'Courier New', monospace;
}

.timer-sub {
    font-size: 0.9em;
    color: #888;
    margin-top: 2px;
}

.timer-badge {
    display: inline-block;
    padding: 3px 10px;
    background: linear-gradient(145deg, rgba(168, 85, 247, 0.3), rgba(168, 85, 247, 0.15));
    border: 1px solid rgba(168, 85, 247, 0.5);
    border-radius: 15px;
    font-size: 0.8em;
    color: #c084fc;
    margin-top: 8px;
    animation: badgePulse 2s infinite;
}

@keyframes badgePulse {

    0%,
    100% {
        opacity: 1;
        box-shadow: 0 0 10px rgba(168, 85, 247, 0.3);
    }

    50% {
        opacity: 0.8;
        box-shadow: 0 0 20px rgba(168, 85, 247, 0.5);
    }
}

.timer-warning {
    font-size: 0.85em;
    color: #ff6b6b;
    margin-top: 5px;
    padding: 4px 10px;
    background: rgba(244, 67, 54, 0.15);
    border-radius: 10px;
    border: 1px solid rgba(244, 67, 54, 0.3);
    animation: warningPulse 1s infinite;
}

@keyframes warningPulse {

    0%,
    100% {
        opacity: 1;
    }

    50% {
        opacity: 0.6;
    }
}

/* 閻犱讲鍓濆鍌炲闯閵娧勫經闁癸拷鍎虫慨鎼佸箑?*/
.timer-main.urgent {
    color: #ff4444;
    animation: timerUrgent 0.5s infinite;
}

@keyframes timerUrgent {

    0%,
    100% {
        color: #ff4444;
        text-shadow: 0 0 15px rgba(255, 68, 68, 0.8);
    }

    50% {
        color: #ff8888;
        text-shadow: 0 0 25px rgba(255, 68, 68, 1);
    }
}

/* 閻犱讲鍓濆鍌炲闯閵娿劎绠婚幖杈鹃檮濞硷拷 */
.timer-progress {
    width: 100%;
    height: 4px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 2px;
    margin-top: 8px;
    overflow: hidden;
}

.timer-progress-bar {
    height: 100%;
    background: linear-gradient(90deg, #00ff88, #ffd700);
    border-radius: 2px;
    transition: width 0.3s ease;
}

.timer-progress-bar.warning {
    background: linear-gradient(90deg, #ffd700, #ff9800);
}

.timer-progress-bar.danger {
    background: linear-gradient(90deg, #ff9800, #ff4444);
    animation: progressDanger 0.5s infinite;
}

@keyframes progressDanger {

    0%,
    100% {
        opacity: 1;
    }

    50% {
        opacity: 0.7;
    }
}

/* 闁轰胶澧楀畵浣烘喆閸℃绂堥柟鍨涘亾闁煎疇濮ょ€垫粓鏌﹂敓鐣屽鐎碉拷?*/
.data-view-skill {
    display: flex;
    justify-content: center;
    margin-bottom: 15px;
}

.skill-btn {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 25px;
    background: linear-gradient(145deg, #1a3a5a, #0f2a4a);
    border: 2px solid rgba(0, 212, 255, 0.4);
    border-radius: 25px;
    color: #00d4ff;
    font-size: 1em;
    cursor: pointer;
    transition: all 0.3s;
    box-shadow: 0 4px 15px rgba(0, 212, 255, 0.2);
}

.skill-btn:hover:not(:disabled) {
    transform: scale(1.05);
    box-shadow: 0 6px 25px rgba(0, 212, 255, 0.4);
    border-color: #00d4ff;
}

.skill-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    border-color: #444;
    color: #666;
}

.skill-icon {
    font-size: 1.3em;
}

.skill-count {
    padding: 2px 8px;
    background: rgba(0, 212, 255, 0.2);
    border-radius: 10px;
    font-size: 0.85em;
    font-weight: bold;
}

.skill-count.empty {
    background: rgba(100, 100, 100, 0.2);
    color: #666;
}

/* 缂佸锟芥慨鈺冪博閿熻В鍋撻崒鐐插赋 */
@media (max-width: 800px) {
    .story-hud {
        flex-direction: column;
        gap: 12px;
        padding: 12px 15px;
    }

    .story-hud-left,
    .story-hud-right {
        text-align: center;
        min-width: auto;
    }

    .story-hud-center {
        justify-content: center;
    }

    .rule-tag {
        font-size: 0.75em;
        padding: 4px 10px;
    }

    .timer-main {
        font-size: 1.2em;
    }
}

/* ========== 濞戞挻妲掕ぐ宥夊础閺囩噦鎷峰ù锝呯У濡绮堥悜妯煎鐎碉拷?========== */

.story-rank-display {
    background: linear-gradient(145deg, rgba(255, 215, 0, 0.15), rgba(255, 215, 0, 0.05));
    border: 1px solid rgba(255, 215, 0, 0.3);
    border-radius: 20px;
    padding: 10px 20px;
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
}

.story-rank-display .rank-icon {
    font-size: 1.5em;
}

.story-rank-display .rank-label {
    font-size: 1em;
    color: #ffd700;
    font-weight: bold;
    text-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
}

/* ========== 缂佸倷鐒︽晶婊堝极濞嗗骏鎷烽悹鍥у⒔閳诲ジ妫冮姀鈩冪凡闁哄秴鍢茬槐锟?========== */

#forbidden-lesson-panel {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.85);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 3000;
}

#forbidden-lesson-panel.hidden {
    display: none;
}

.lesson-modal {
    background: linear-gradient(145deg, #1a1a35, #12122a);
    border: 2px solid rgba(100, 200, 255, 0.3);
    border-radius: 20px;
    padding: 30px;
    max-width: 520px;
    width: 90%;
    box-shadow: 0 0 40px rgba(100, 200, 255, 0.2);
    animation: lessonFadeIn 0.3s ease-out;
}

@keyframes lessonFadeIn {
    from {
        opacity: 0;
        transform: translateY(-20px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.lesson-header {
    text-align: center;
    margin-bottom: 20px;
}

.lesson-progress {
    display: flex;
    justify-content: center;
    gap: 8px;
    margin-bottom: 15px;
}

.progress-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.2);
    transition: all 0.3s ease;
}

.progress-dot.active {
    background: #64c8ff;
    box-shadow: 0 0 10px rgba(100, 200, 255, 0.5);
    transform: scale(1.2);
}

.progress-dot.done {
    background: rgba(100, 200, 255, 0.5);
}

.lesson-title {
    font-size: 1.5em;
    color: #fff;
    margin: 0;
    text-shadow: 0 0 15px rgba(100, 200, 255, 0.3);
}

.lesson-body {
    margin-bottom: 25px;
}

.lesson-speaker {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 15px;
    padding-bottom: 15px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.speaker-icon {
    font-size: 1.8em;
}

.speaker-name {
    font-size: 1.1em;
    color: #64c8ff;
    font-weight: bold;
}

.lesson-content {
    color: rgba(255, 255, 255, 0.9);
    line-height: 1.8;
    font-size: 0.95em;
}

.lesson-content p {
    margin: 0 0 12px 0;
}

.lesson-content p:last-child {
    margin-bottom: 0;
}

.lesson-demo {
    margin-top: 20px;
    text-align: center;
}

.lesson-demo canvas {
    border: 2px solid rgba(100, 200, 255, 0.3);
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
}

.lesson-demo-annotation {
    margin-top: 12px;
    font-size: 0.85em;
    color: rgba(255, 200, 100, 0.9);
    font-style: italic;
}

.lesson-footer {
    display: flex;
    justify-content: space-between;
    gap: 15px;
}

.lesson-btn {
    flex: 1;
    padding: 12px 24px;
    border: none;
    border-radius: 10px;
    font-size: 1em;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s ease;
}

.lesson-btn-prev {
    background: rgba(255, 255, 255, 0.1);
    color: rgba(255, 255, 255, 0.7);
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.lesson-btn-prev:hover {
    background: rgba(255, 255, 255, 0.15);
    color: #fff;
}

.lesson-btn-prev.hidden {
    visibility: hidden;
}

.lesson-btn-next {
    background: linear-gradient(145deg, #4a9eff, #2a7edf);
    color: #fff;
    box-shadow: 0 4px 15px rgba(74, 158, 255, 0.3);
}

.lesson-btn-next:hover {
    background: linear-gradient(145deg, #5aafff, #3a8eff);
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(74, 158, 255, 0.4);
}

/* ==========================================================================
   SAFETY FIX & MISSING STYLES RESTORATION
   ========================================================================== */

/* Previous unclosed blocks issue has been resolved */

.mission-list {
    display: flex;
    flex-direction: column;
    gap: 15px;
    width: 100%;
}

.mission-card {
    display: flex;
    flex-direction: row;
    /* Horizontal by default */
    background: rgba(255, 255, 255, 0.08);
    /* Dark theme */
    border-radius: 12px;
    overflow: hidden;
    cursor: pointer;
    transition: all 0.2s ease;
    border: 1px solid rgba(255, 255, 255, 0.1);
    min-height: 100px;
    width: 100%;
}

.mission-card:hover {
    background: rgba(255, 255, 255, 0.15);
    transform: translateY(-2px);
}

.mission-thumb {
    width: 120px;
    background-size: cover;
    background-position: center;
    flex-shrink: 0;
    background-color: #222;
}

.mission-info {
    flex: 1;
    padding: 12px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    gap: 6px;
    min-width: 0;
    /* Critical for flex text wrapping */
}

.mission-title {
    font-size: 1.1em;
    font-weight: bold;
    color: #fff;
    margin-bottom: 2px;
}

/* mission-tagline 瀹告彃婀粭锟?272鐞涘苯鐣炬稊澶涚礉濮濄倕锟介崚鐘绘珟闁灝鍘ら崘鑼崐 */

.mission-difficulty {
    font-size: 0.8em;
    color: #ffd700;
}

.mission-action {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 10px;
    min-width: 90px;
}

.mission-action-btn {
    padding: 6px 12px;
    border-radius: 20px;
    border: none;
    font-size: 0.85em;
    cursor: pointer;
    background: rgba(255, 255, 255, 0.1);
    color: #ddd;
    transition: all 0.2s;
}

.mission-card:hover .mission-action-btn {
    background: #a855f7;
    color: #fff;
}

/* Status Badges */
.mission-status {
    display: inline-block;
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 0.75em;
    margin-top: 4px;
    width: fit-content;
}

.mission-status.locked {
    background: #333;
    color: #777;
}

.mission-status.current {
    background: rgba(168, 85, 247, 0.2);
    color: #a855f7;
    border: 1px solid rgba(168, 85, 247, 0.3);
}

.mission-status.finished {
    background: rgba(34, 197, 94, 0.2);
    color: #22c55e;
    border: 1px solid rgba(34, 197, 94, 0.3);
}


/* ========== Laptop / Small Desktop Adaptations (769px - 1200px) ========== */
@media screen and (min-width: 769px) and (max-width: 1200px) {
    .container {
        width: 100%;
        max-width: 100%;
        padding: 5px;
    }

    .game-layout {
        gap: 10px;
        justify-content: space-evenly;
    }

    /* Shrink board to fit height/width */
    .game-container {
        width: auto;
        max-width: 45vh;
        /* Scale based on viewport height to avoid scrolling */
        aspect-ratio: 1/1;
    }

    .game-info {
        width: 320px;
        /* Constrain sidebar width */
        min-width: 300px;
    }

    /* Adjust headers */
    h1 {
        font-size: 1.8em;
        margin-top: 10px;
    }
}



/* ========== DESKTOP BASE CONSTRAINTS (Restoring Widths) ========== */
/* These rules provide the default wide layout for Desktop. */
/* Mobile.css is isolated and will ignore these or override them via responsive logic in another file. */

.modal-content,
.mode-select-content,
.mission-select-content {
    width: 600px;
    max-width: 90%;
}

.game-container {
    width: 600px;
    /* Default logic size */
    /* Note: Laptop adapter's max-width will constrain this if needed */
}

.game-layout {
    flex-direction: row;
    /* Force horizontal */
    justify-content: center;
    gap: 40px;
}





/* ========== GLOBAL INTERFACE SCALING (Laptop Optimization) ========== */
/* Scales the entire UI down on shorter screens to prevent scrolling */
/* Does not change layout relative positions, only size */

@media screen and (min-width: 769px) and (max-height: 860px) {

    .container,
    .modal,
    .lesson-modal,
    #message-toast {
        zoom: 0.8;
        /* Scale to 80% */

        /* Firefox Fallback */
        -moz-transform: scale(0.8);
        -moz-transform-origin: center center;
        transform: scale(0.8);
        transform-origin: center center;
    }
}

@media screen and (min-width: 769px) and (max-height: 720px) {

    .container,
    .modal,
    .lesson-modal,
    #message-toast {
        zoom: 0.75;
        /* Scale to 75% for very short screens (e.g. 1366x768) */

        -moz-transform: scale(0.75);
        transform: scale(0.75);
    }
}

/* ========== 閸旂姾娴囩仦蹇撶閺嶅嘲绱?========== */
.loading-screen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, #0a0a1a 0%, #1a1a3a 50%, #0a0a1a 100%);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10000;
    transition: opacity 0.5s ease;
}

.loading-screen.fade-out {
    opacity: 0;
}

.loading-screen.hidden {
    display: none;
}

/* ========== 量子纠缠风格加载页面 ========== */
.loading-screen.quantum-theme {
    background: radial-gradient(ellipse at center, #0d0d20 0%, #050510 50%, #000005 100%);
    overflow: hidden;
}

/* 量子粒子背景 */
.quantum-particles {
    position: absolute;
    width: 100%;
    height: 100%;
    overflow: hidden;
    pointer-events: none;
}

.quantum-particle {
    position: absolute;
    width: 3px;
    height: 3px;
    background: rgba(120, 180, 255, 0.8);
    border-radius: 50%;
    box-shadow: 0 0 10px rgba(120, 180, 255, 0.6), 0 0 20px rgba(120, 180, 255, 0.3);
}

.quantum-particle.p1 {
    left: 10%;
    top: 20%;
    animation: particleFloat 8s ease-in-out infinite;
}

.quantum-particle.p2 {
    left: 80%;
    top: 10%;
    animation: particleFloat 12s ease-in-out infinite 1s;
}

.quantum-particle.p3 {
    left: 25%;
    top: 70%;
    animation: particleFloat 10s ease-in-out infinite 2s;
}

.quantum-particle.p4 {
    left: 70%;
    top: 60%;
    animation: particleFloat 9s ease-in-out infinite 0.5s;
}

.quantum-particle.p5 {
    left: 50%;
    top: 85%;
    animation: particleFloat 11s ease-in-out infinite 3s;
}

.quantum-particle.p6 {
    left: 90%;
    top: 40%;
    animation: particleFloat 7s ease-in-out infinite 1.5s;
}

@keyframes particleFloat {

    0%,
    100% {
        transform: translate(0, 0) scale(1);
        opacity: 0.6;
    }

    25% {
        transform: translate(20px, -30px) scale(1.2);
        opacity: 1;
    }

    50% {
        transform: translate(-10px, -50px) scale(0.8);
        opacity: 0.8;
    }

    75% {
        transform: translate(15px, -20px) scale(1.1);
        opacity: 0.9;
    }
}

/* 量子波纹 - 现在在纠缠容器内 */
.quantum-ripples {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    pointer-events: none;
    z-index: 0;
    /* 在棋子后面 */
}

.quantum-ripple {
    position: absolute;
    border: 1px solid rgba(100, 150, 255, 0.15);
    border-radius: 50%;
}

.quantum-ripple.r1 {
    width: 300px;
    height: 300px;
    animation: rippleExpand 4s ease-out infinite;
}

.quantum-ripple.r2 {
    width: 300px;
    height: 300px;
    animation: rippleExpand 4s ease-out infinite 1.3s;
}

.quantum-ripple.r3 {
    width: 300px;
    height: 300px;
    animation: rippleExpand 4s ease-out infinite 2.6s;
}

@keyframes rippleExpand {
    0% {
        transform: scale(0.3);
        opacity: 0.6;
        border-color: rgba(150, 120, 255, 0.4);
    }

    100% {
        transform: scale(2.5);
        opacity: 0;
        border-color: rgba(100, 180, 255, 0.1);
    }
}

/* 量子标题 */
.quantum-logo {
    position: relative;
    margin-bottom: 50px;
}

.quantum-logo .logo-text {
    font-size: 3em;
    font-weight: 300;
    letter-spacing: 0.3em;
    color: #fff;
    text-shadow:
        0 0 30px rgba(150, 120, 255, 0.8),
        0 0 60px rgba(100, 150, 255, 0.5),
        0 0 100px rgba(80, 120, 255, 0.3);
    animation: logoBreath 4s ease-in-out infinite;
}

.quantum-logo .logo-glow {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 120%;
    height: 200%;
    background: radial-gradient(ellipse at center, rgba(120, 100, 255, 0.15) 0%, transparent 70%);
    animation: glowPulse 3s ease-in-out infinite;
    pointer-events: none;
}

@keyframes logoBreath {

    0%,
    100% {
        opacity: 0.9;
        transform: scale(1);
    }

    50% {
        opacity: 1;
        transform: scale(1.02);
    }
}

@keyframes glowPulse {

    0%,
    100% {
        opacity: 0.5;
        transform: translate(-50%, -50%) scale(1);
    }

    50% {
        opacity: 0.8;
        transform: translate(-50%, -50%) scale(1.1);
    }
}

/* 量子纠缠棋子动画 */
.quantum-entanglement {
    position: relative;
    width: 180px;
    height: 180px;
    margin: 0 auto 40px;
    display: flex;
    justify-content: center;
    align-items: center;
}

.entanglement-orbit {
    position: absolute;
    width: 100%;
    height: 100%;
    left: 0;
    top: 0;
    animation: orbitRotate 6s linear infinite;
}

.quantum-stone {
    position: absolute;
    width: 50px;
    height: 50px;
    border-radius: 50%;
}

/* 黑棋 - 左侧，相对于中心点85px */
.stone-yin {
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%) translateX(-65px);
    background: radial-gradient(circle at 35% 35%, #444, #0a0a0a);
    box-shadow:
        0 0 20px rgba(0, 0, 0, 0.8),
        inset 0 -8px 15px rgba(0, 0, 0, 0.9),
        inset 0 8px 15px rgba(100, 100, 100, 0.2);
}

/* 白棋 - 右侧，相对于中心点85px */
.stone-yang {
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%) translateX(65px);
    background: radial-gradient(circle at 35% 35%, #fff, #ccc);
    box-shadow:
        0 0 25px rgba(255, 255, 255, 0.6),
        inset 0 -8px 15px rgba(0, 0, 0, 0.15),
        inset 0 8px 15px rgba(255, 255, 255, 0.8);
}

/* 量子纠缠光束 - 连接两颗棋子 */
.entanglement-beam {
    position: absolute;
    left: 50%;
    top: 50%;
    width: 80px;
    /* 两颗棋子之间的距离 */
    height: 2px;
    transform: translate(-50%, -50%);
    background: linear-gradient(90deg,
            rgba(150, 100, 255, 0.3) 0%,
            rgba(100, 200, 255, 1) 50%,
            rgba(150, 100, 255, 0.3) 100%);
    animation: beamPulse 2s ease-in-out infinite;
    box-shadow: 0 0 15px rgba(100, 150, 255, 0.8);
}

@keyframes beamPulse {

    0%,
    100% {
        opacity: 0.5;
        transform: translateY(-50%) scaleX(0.9);
    }

    50% {
        opacity: 1;
        transform: translateY(-50%) scaleX(1);
    }
}

/* 纠缠核心 - 固定在波纹圆圈正中心，不跟随旋转 */
.entanglement-core {
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    width: 25px;
    height: 25px;
    background: radial-gradient(circle,
            rgba(180, 150, 255, 1) 0%,
            rgba(120, 100, 255, 0.8) 30%,
            rgba(100, 150, 255, 0.4) 60%,
            transparent 80%);
    border-radius: 50%;
    animation: corePulse 1.5s ease-in-out infinite;
    z-index: 10;
    /* 确保在棋子上方 */
}

@keyframes corePulse {

    0%,
    100% {
        transform: translate(-50%, -50%) scale(1);
        box-shadow: 0 0 20px rgba(150, 100, 255, 0.8);
    }

    50% {
        transform: translate(-50%, -50%) scale(1.5);
        box-shadow: 0 0 40px rgba(100, 180, 255, 1);
    }
}

@keyframes orbitRotate {
    0% {
        transform: rotate(0deg);
    }

    100% {
        transform: rotate(360deg);
    }
}

/* 量子状态文字 */
.quantum-status {
    text-align: center;
    margin-bottom: 30px;
}

.quantum-status .status-main {
    font-size: 1.4em;
    color: rgba(180, 200, 255, 0.95);
    letter-spacing: 0.15em;
    margin-bottom: 8px;
    font-weight: 300;
    text-shadow: 0 0 20px rgba(100, 150, 255, 0.6);
    animation: statusPulse 2s ease-in-out infinite;
}

.quantum-status .status-sub {
    font-size: 0.95em;
    color: rgba(150, 180, 220, 0.7);
    letter-spacing: 0.1em;
}

@keyframes statusPulse {

    0%,
    100% {
        opacity: 0.8;
    }

    50% {
        opacity: 1;
    }
}

/* 量子进度条 */
.quantum-progress-container {
    width: 280px;
    margin: 0 auto 30px;
}

.quantum-progress-track {
    position: relative;
    height: 4px;
    background: rgba(100, 150, 200, 0.15);
    border-radius: 2px;
    overflow: hidden;
}

.quantum-progress-bar {
    height: 100%;
    width: 0%;
    background: linear-gradient(90deg,
            rgba(100, 150, 255, 0.8) 0%,
            rgba(150, 100, 255, 1) 50%,
            rgba(100, 200, 255, 0.8) 100%);
    border-radius: 2px;
    transition: width 0.3s ease;
    box-shadow: 0 0 15px rgba(130, 150, 255, 0.8);
}

.quantum-progress-glow {
    position: absolute;
    top: -2px;
    left: 0;
    width: 30%;
    height: 8px;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
    animation: progressGlowMove 2s linear infinite;
    border-radius: 4px;
}

@keyframes progressGlowMove {
    0% {
        left: -30%;
    }

    100% {
        left: 100%;
    }
}

.quantum-progress-text {
    text-align: right;
    margin-top: 8px;
}

.quantum-progress-text .loading-percentage {
    font-size: 0.9em;
    color: rgba(150, 180, 220, 0.8);
    letter-spacing: 0.1em;
}

/* 量子底部提示 */
.quantum-tip {
    font-size: 0.85em;
    color: rgba(140, 160, 200, 0.6);
    letter-spacing: 0.2em;
    animation: tipFade 3s ease-in-out infinite;
}

.loading-content {
    text-align: center;
    color: #fff;
}

.loading-logo {
    font-size: 2.5em;
    font-weight: bold;
    margin-bottom: 40px;
    text-shadow: 0 0 30px rgba(0, 212, 255, 0.8);
    animation: logoPulse 2s ease-in-out infinite;
}

@keyframes logoPulse {

    0%,
    100% {
        transform: scale(1);
        opacity: 1;
    }

    50% {
        transform: scale(1.05);
        opacity: 0.9;
    }
}

.loading-stones {
    display: flex;
    justify-content: center;
    gap: 30px;
    margin-bottom: 30px;
}

.stone {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    animation: stoneBounce 1.4s ease-in-out infinite;
}

.stone-black {
    background: radial-gradient(circle at 30% 30%, #555, #111);
    box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5), inset 0 -5px 15px rgba(0, 0, 0, 0.8);
    animation-delay: 0s;
}

.stone-white {
    background: radial-gradient(circle at 30% 30%, #fff, #ccc);
    box-shadow: 0 5px 20px rgba(255, 255, 255, 0.3), inset 0 -5px 15px rgba(0, 0, 0, 0.1);
    animation-delay: 0.7s;
}

@keyframes stoneBounce {

    0%,
    100% {
        transform: translateY(0) scale(1);
    }

    50% {
        transform: translateY(-20px) scale(1.1);
    }
}

.loading-text {
    font-size: 1.2em;
    color: #00d4ff;
    margin-bottom: 20px;
}

.loading-dots::after {
    content: '';
    animation: loadingDots 1.5s infinite;
}

@keyframes loadingDots {
    0% {
        content: '';
    }

    25% {
        content: '.';
    }

    50% {
        content: '..';
    }

    75% {
        content: '...';
    }

    100% {
        content: '';
    }
}

.loading-bar {
    width: 250px;
    height: 6px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 3px;
    margin: 0 auto 15px;
    overflow: hidden;
}

.loading-progress {
    width: 0%;
    height: 100%;
    background: linear-gradient(90deg, #00d4ff, #a855f7);
    border-radius: 3px;
    transition: width 0.3s ease;
}

.loading-tip {
    font-size: 0.9em;
    color: rgba(255, 255, 255, 0.6);
}

/* ========== 閻溾晛锟芥慨鎾虫倳鏉堟挸鍙嗗鍦崶閺嶅嘲绱?========== */
.name-input-content {
    max-width: 400px;
    padding: 40px 35px;
    text-align: center;
    background: linear-gradient(145deg, rgba(20, 20, 50, 0.98), rgba(30, 30, 70, 0.95));
    border: 1px solid rgba(0, 212, 255, 0.3);
    border-radius: 20px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.6), 0 0 50px rgba(0, 212, 255, 0.15);
}

.name-input-header {
    margin-bottom: 30px;
}

.welcome-icon {
    font-size: 3em;
    margin-bottom: 15px;
    animation: iconFloat 3s ease-in-out infinite;
}

@keyframes iconFloat {

    0%,
    100% {
        transform: translateY(0);
    }

    50% {
        transform: translateY(-10px);
    }
}

.name-input-header h2 {
    color: #fff;
    font-size: 1.6em;
    margin-bottom: 10px;
    text-shadow: 0 0 15px rgba(0, 212, 255, 0.5);
}

.welcome-subtitle {
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.95em;
}

.name-input-body {
    margin-bottom: 25px;
}

.name-input-body label {
    display: block;
    color: #00d4ff;
    font-size: 0.95em;
    margin-bottom: 12px;
    text-align: left;
}

.name-input {
    width: 100%;
    padding: 15px 20px;
    font-size: 1.1em;
    color: #fff;
    background: rgba(0, 0, 0, 0.4);
    border: 2px solid rgba(0, 212, 255, 0.3);
    border-radius: 12px;
    outline: none;
    transition: all 0.3s ease;
}

.name-input:focus {
    border-color: #00d4ff;
    box-shadow: 0 0 20px rgba(0, 212, 255, 0.3);
}

.name-input::placeholder {
    color: rgba(255, 255, 255, 0.4);
}

.name-hint {
    color: rgba(255, 255, 255, 0.5);
    font-size: 0.85em;
    margin-top: 10px;
    text-align: left;
}

.start-btn {
    width: 100%;
    padding: 15px 30px;
    font-size: 1.1em;
    font-weight: bold;
    color: #fff;
    background: linear-gradient(135deg, #00d4ff, #0099cc);
    border: none;
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 5px 25px rgba(0, 212, 255, 0.4);
}

.start-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 35px rgba(0, 212, 255, 0.5);
}

.start-btn:active {
    transform: translateY(0);
}

/* ========== 娑擄拷姹夐幋妯煎摋瀵湱鐛ラ弽宄扮础 ========== */
.stats-modal-content {
    max-width: 500px;
    padding: 30px;
    background: linear-gradient(145deg, rgba(15, 15, 35, 0.98), rgba(25, 25, 55, 0.95));
    border: 1px solid rgba(0, 212, 255, 0.3);
    border-radius: 20px;
    position: relative;
}

.stats-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 25px;
}

.stats-header h2 {
    margin: 0;
    color: #fff;
    font-size: 1.5em;
    text-shadow: 0 0 15px rgba(0, 212, 255, 0.5);
}

/* 鐟曞棛娲?stats 閸滐拷 leaderboard 瀵湱鐛ユ稉锟芥畱閸忔娊妫撮幐澶愭尦鐎规矮缍?*/
.stats-header .close-btn,
.leaderboard-header .close-btn {
    position: static;
    flex-shrink: 0;
}

/* 閻溾晛锟芥穱鈩冧紖閸楋紕澧?*/
.stats-player-card {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 20px;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 15px;
    margin-bottom: 20px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.player-avatar {
    font-size: 2.5em;
    width: 60px;
    height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(96, 165, 250, 0.15);
    border: 2px solid rgba(96, 165, 250, 0.3);
    border-radius: 50%;
}

.player-info {
    flex: 1;
}

.stats-player-card .player-name {
    font-size: 1.3em;
    font-weight: bold;
    color: #fff;
    margin-bottom: 5px;
}

.player-rank {
    display: flex;
    align-items: center;
    gap: 5px;
    color: #00d4ff;
    font-size: 0.95em;
}

.player-total {
    text-align: center;
}

.total-games {
    font-size: 2em;
    font-weight: bold;
    color: #60a5fa;
}

.total-label {
    font-size: 0.8em;
    color: rgba(255, 255, 255, 0.6);
}

/* 閹槒鍎ㄩ悳锟?*/
.stats-winrate-section {
    display: flex;
    align-items: center;
    gap: 15px;
    margin-bottom: 20px;
    padding: 15px;
    background: rgba(0, 0, 0, 0.2);
    border-radius: 12px;
}

.winrate-label {
    color: rgba(255, 255, 255, 0.8);
    font-size: 0.95em;
    min-width: 60px;
}

.winrate-bar-container {
    flex: 1;
    height: 12px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 6px;
    overflow: hidden;
}

.winrate-bar {
    height: 100%;
    background: #a78bfa;
    border-radius: 6px;
    transition: width 0.5s ease;
}

.winrate-value {
    color: #a78bfa;
    font-size: 1.2em;
    font-weight: bold;
    min-width: 50px;
    text-align: right;
}

/* 閸掑棙膩瀵繒绮虹拋锟?*/
.stats-modes-section {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 12px;
    margin-bottom: 20px;
}

.stats-mode-card {
    padding: 15px 10px;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 12px;
    text-align: center;
    border: 1px solid rgba(255, 255, 255, 0.08);
    transition: all 0.3s ease;
}

.stats-mode-card:hover {
    border-color: rgba(0, 212, 255, 0.3);
    transform: translateY(-3px);
}

.stats-mode-card .mode-icon {
    font-size: 1.8em;
    margin-bottom: 8px;
}

.stats-mode-card .mode-name {
    font-size: 0.85em;
    color: rgba(255, 255, 255, 0.8);
    margin-bottom: 8px;
}

.stats-mode-card .mode-stats {
    display: flex;
    justify-content: center;
    gap: 6px;
    font-size: 0.75em;
    margin-bottom: 8px;
}

.stats-mode-card .wins {
    color: #60a5fa;
}

.stats-mode-card .losses {
    color: #94a3b8;
}

.stats-mode-card .draws {
    color: #cbd5e1;
}

.stats-mode-card .mode-winrate {
    font-size: 1.1em;
    font-weight: bold;
    color: #60a5fa;
}

/* 濞堝吀缍呮潻娑樺 */
.stats-rank-progress {
    padding: 15px;
    background: rgba(0, 0, 0, 0.2);
    border-radius: 12px;
}

.rank-progress-label {
    display: flex;
    justify-content: space-between;
    margin-bottom: 10px;
    font-size: 0.9em;
    color: rgba(255, 255, 255, 0.8);
}

.rank-progress-label #stats-next-rank {
    color: #a855f7;
}

.rank-progress-bar-container {
    height: 10px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 5px;
    overflow: hidden;
}

.rank-progress-bar {
    height: 100%;
    background: #a78bfa;
    border-radius: 5px;
    transition: width 0.5s ease;
}

/* 缂佺喕锟介幐澶愭尦閺嶅嘲绱?*/
.stats-btn {
    background: linear-gradient(135deg, rgba(168, 85, 247, 0.3), rgba(0, 212, 255, 0.2)) !important;
    border-color: rgba(168, 85, 247, 0.4) !important;
}

.stats-btn:hover {
    border-color: #a855f7 !important;
    box-shadow: 0 0 25px rgba(168, 85, 247, 0.4) !important;
}

/* 閻溾晛锟介崥宥囆炵悰锟?*/
.player-name-row {
    display: flex;
    align-items: center;
    gap: 8px;
}

.rename-btn {
    background: transparent;
    border: none;
    cursor: pointer;
    font-size: 0.9em;
    opacity: 0.6;
    transition: all 0.2s ease;
    padding: 3px 6px;
    border-radius: 5px;
}

.rename-btn:hover {
    opacity: 1;
    background: rgba(0, 212, 255, 0.2);
}

/* 閺€鐟版倳鐞涖劌宕?*/
.rename-form {
    padding: 15px;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 12px;
    margin-bottom: 20px;
    border: 1px solid rgba(0, 212, 255, 0.2);
}

.rename-form.hidden {
    display: none;
}

.rename-input {
    width: 100%;
    padding: 12px 15px;
    font-size: 1em;
    color: #fff;
    background: rgba(0, 0, 0, 0.4);
    border: 2px solid rgba(0, 212, 255, 0.3);
    border-radius: 10px;
    outline: none;
    margin-bottom: 12px;
    transition: all 0.3s ease;
}

.rename-input:focus {
    border-color: #00d4ff;
    box-shadow: 0 0 15px rgba(0, 212, 255, 0.3);
}

.rename-actions {
    display: flex;
    gap: 10px;
}

.rename-confirm {
    flex: 1;
    padding: 10px 20px;
    background: linear-gradient(135deg, #00d4ff, #0099cc);
    color: #fff;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
    transition: all 0.2s ease;
}

.rename-confirm:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 20px rgba(0, 212, 255, 0.4);
}

.rename-cancel {
    flex: 1;
    padding: 10px 20px;
    background: rgba(255, 255, 255, 0.1);
    color: rgba(255, 255, 255, 0.8);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
}

.rename-cancel:hover {
    background: rgba(255, 255, 255, 0.2);
}

/* ========== 娑撴牜鏅幒鎺曪拷濮掓粍鐗卞锟?========== */
.leaderboard-btn {
    background: linear-gradient(135deg, rgba(255, 193, 7, 0.3), rgba(255, 152, 0, 0.2)) !important;
    border-color: rgba(255, 193, 7, 0.4) !important;
}

.leaderboard-btn:hover {
    border-color: #ffc107 !important;
    box-shadow: 0 0 25px rgba(255, 193, 7, 0.4) !important;
}

.leaderboard-modal-content {
    max-width: 480px;
    padding: 25px;
    background: linear-gradient(145deg, rgba(15, 15, 35, 0.98), rgba(25, 25, 55, 0.95));
    border: 1px solid rgba(255, 193, 7, 0.3);
    border-radius: 20px;
}

.leaderboard-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
}

.leaderboard-header h2 {
    margin: 0;
    color: #ffc107;
    font-size: 1.4em;
    text-shadow: 0 0 15px rgba(255, 193, 7, 0.5);
}

.leaderboard-actions {
    display: flex;
    gap: 10px;
}

.refresh-btn {
    background: transparent;
    border: none;
    cursor: pointer;
    font-size: 1.2em;
    opacity: 0.7;
    transition: all 0.2s ease;
}

.refresh-btn:hover {
    opacity: 1;
    transform: rotate(180deg);
}

.leaderboard-subtitle {
    color: rgba(255, 255, 255, 0.6);
    font-size: 0.85em;
    margin-bottom: 15px;
}

.leaderboard-list {
    max-height: 400px;
    overflow-y: auto;
}

.leaderboard-loading,
.leaderboard-empty {
    text-align: center;
    padding: 40px 20px;
    color: rgba(255, 255, 255, 0.6);
    font-size: 1em;
}

.leaderboard-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 15px;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 12px;
    margin-bottom: 8px;
    border: 1px solid transparent;
    transition: all 0.2s ease;
}

.leaderboard-item:hover {
    border-color: rgba(255, 255, 255, 0.1);
    transform: translateX(5px);
}

.leaderboard-item.is-me {
    background: rgba(0, 212, 255, 0.15);
    border-color: rgba(0, 212, 255, 0.3);
}

.leaderboard-item.rank-1 {
    background: linear-gradient(90deg, rgba(255, 215, 0, 0.2), transparent);
    border-color: rgba(255, 215, 0, 0.3);
}

.leaderboard-item.rank-2 {
    background: linear-gradient(90deg, rgba(192, 192, 192, 0.15), transparent);
    border-color: rgba(192, 192, 192, 0.3);
}

.leaderboard-item.rank-3 {
    background: linear-gradient(90deg, rgba(205, 127, 50, 0.15), transparent);
    border-color: rgba(205, 127, 50, 0.3);
}

.lb-rank {
    font-size: 1.3em;
    min-width: 40px;
    text-align: center;
}

.lb-player {
    flex: 1;
}

.lb-name {
    font-weight: bold;
    color: #fff;
    font-size: 1em;
    margin-bottom: 2px;
}

.lb-tier {
    font-size: 0.8em;
    color: rgba(255, 255, 255, 0.6);
}

.lb-stats {
    text-align: right;
}

.lb-winrate {
    font-size: 1.1em;
    font-weight: bold;
    color: #00ff88;
}

.lb-games {
    font-size: 0.75em;
    color: rgba(255, 255, 255, 0.5);
}

/* ========== 閻楀牊婀伴崗锟芥啞瀵湱鐛ラ弽宄扮础 ========== */
#version-modal {
    z-index: 1100;
    /* 濮ｆ柨鍙炬禒鏍ц剨缁愭娲挎锟?*/
}

.version-content {
    max-width: 480px;
    padding: 25px 30px;
    background: linear-gradient(145deg, rgba(15, 15, 40, 0.98), rgba(25, 25, 60, 0.95));
    border: 1px solid rgba(0, 212, 255, 0.3);
    border-radius: 20px;
}

.version-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.version-icon {
    font-size: 2em;
}

.version-header h2 {
    flex: 1;
    margin: 0;
    color: #fff;
    font-size: 1.4em;
}

.version-tag {
    padding: 4px 12px;
    background: linear-gradient(135deg, #00d4ff, #a855f7);
    border-radius: 20px;
    font-size: 0.85em;
    font-weight: bold;
    color: #fff;
}

.version-date {
    color: rgba(255, 255, 255, 0.5);
    font-size: 0.85em;
    margin-bottom: 15px;
}

.version-section {
    margin-bottom: 18px;
}

.version-section h3 {
    color: #00d4ff;
    font-size: 1em;
    margin-bottom: 10px;
}

.version-section ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

.version-section li {
    color: rgba(255, 255, 255, 0.85);
    font-size: 0.9em;
    padding: 6px 0;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
}

.version-section li:last-child {
    border-bottom: none;
}

.version-section li strong {
    color: #fff;
}

.version-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 20px;
    padding-top: 15px;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.version-checkbox {
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
    color: rgba(255, 255, 255, 0.6);
    font-size: 0.85em;
}

.version-checkbox input {
    accent-color: #a855f7;
}

.version-close-btn {
    padding: 10px 25px;
    background: linear-gradient(135deg, #00d4ff, #0099cc);
    border: none;
    border-radius: 10px;
    color: #fff;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s ease;
}

.version-close-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 20px rgba(0, 212, 255, 0.4);
}

/* ========== 閻ｆ瑨鈻堥弶鍨剨缁愭鐗卞锟?========== */
.feedback-content {
    max-width: 500px;
    padding: 25px;
    background: linear-gradient(145deg, rgba(15, 15, 40, 0.98), rgba(25, 25, 60, 0.95));
    border: 1px solid rgba(0, 212, 255, 0.3);
    border-radius: 20px;
}

.feedback-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.feedback-header h2 {
    margin: 0;
    color: #fff;
}

.feedback-header .close-btn {
    background: none;
    border: none;
    color: rgba(255, 255, 255, 0.6);
    font-size: 1.5em;
    cursor: pointer;
    transition: color 0.3s;
}

.feedback-header .close-btn:hover {
    color: #ff6b6b;
}

.feedback-intro {
    color: rgba(255, 255, 255, 0.8);
    margin-bottom: 15px;
}

.feedback-textarea {
    width: 100%;
    height: 150px;
    padding: 15px;
    background: rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 10px;
    color: #fff;
    font-size: 1em;
    resize: none;
    outline: none;
    transition: border-color 0.3s;
}

.feedback-textarea:focus {
    border-color: #00d4ff;
}

.feedback-textarea::placeholder {
    color: rgba(255, 255, 255, 0.4);
}

.feedback-counter {
    text-align: right;
    color: rgba(255, 255, 255, 0.5);
    font-size: 0.85em;
    margin-top: 5px;
}

.feedback-footer {
    margin-top: 20px;
    text-align: center;
}

.feedback-submit-btn {
    padding: 12px 30px;
    background: linear-gradient(135deg, #00d4ff, #a855f7);
    border: none;
    border-radius: 10px;
    color: #fff;
    font-size: 1em;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s ease;
}

.feedback-submit-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 20px rgba(168, 85, 247, 0.4);
}

.feedback-history {
    margin-top: 20px;
    max-height: 200px;
    overflow-y: auto;
}

.feedback-item {
    padding: 10px;
    background: rgba(0, 0, 0, 0.2);
    border-radius: 8px;
    margin-bottom: 8px;
    font-size: 0.9em;
    color: rgba(255, 255, 255, 0.8);
}

.feedback-item-time {
    font-size: 0.75em;
    color: rgba(255, 255, 255, 0.4);
    margin-bottom: 5px;
}

.feedback-btn {
    background: linear-gradient(135deg, rgba(168, 85, 247, 0.3), rgba(0, 212, 255, 0.3)) !important;
}

/* ============================================================
   閼辨梹婧€鐎佃鍨弽宄扮础
   ============================================================ */

/* 閼辨梹婧€閹稿鎸砃EW閺嶅洩鐦?*/
.online-btn {
    position: relative;
}

.new-badge {
    position: absolute;
    top: -8px;
    right: -8px;
    background: linear-gradient(135deg, #ff6b6b, #ff8e53);
    color: #fff;
    font-size: 0.65em;
    font-weight: bold;
    padding: 3px 8px;
    border-radius: 10px;
    animation: pulse 2s infinite;
}

/* 閼辨梹婧€婢堆冨泛 */
.online-lobby-content {
    max-width: 420px;
    width: 90%;
}

.online-lobby-body {
    padding: 20px;
}

.online-status {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    margin-bottom: 20px;
    font-size: 0.9em;
    color: rgba(255, 255, 255, 0.7);
}

.status-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: #666;
}

.status-dot.online {
    background: #00ff88;
    box-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
    animation: pulse 2s infinite;
}

.lobby-options {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.lobby-btn {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 15px 20px;
    background: rgba(40, 40, 80, 0.6);
    border: 1px solid rgba(168, 85, 247, 0.3);
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
    text-align: left;
}

.lobby-btn:hover:not(:disabled) {
    background: rgba(168, 85, 247, 0.2);
    border-color: rgba(168, 85, 247, 0.6);
    transform: translateX(5px);
}

.lobby-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.lobby-btn .btn-icon {
    font-size: 2em;
}

.lobby-btn .btn-text {
    display: flex;
    flex-direction: column;
}

.lobby-btn .btn-title {
    font-size: 1.1em;
    font-weight: bold;
    color: #fff;
}

.lobby-btn .btn-subtitle {
    font-size: 0.8em;
    color: rgba(255, 255, 255, 0.6);
}

/* 閸旂姴鍙嗛幋鍧楁？瀵湱鐛?*/
.join-room-content {
    max-width: 350px;
    width: 90%;
}

.join-room-body {
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.room-code-input {
    width: 100%;
    padding: 15px;
    font-size: 1.5em;
    font-family: monospace;
    text-align: center;
    text-transform: uppercase;
    letter-spacing: 8px;
    background: rgba(0, 0, 0, 0.3);
    border: 2px solid rgba(168, 85, 247, 0.3);
    border-radius: 10px;
    color: #fff;
    outline: none;
    transition: border-color 0.3s;
}

.room-code-input:focus {
    border-color: #a855f7;
}

.room-code-input::placeholder {
    letter-spacing: 2px;
    color: rgba(255, 255, 255, 0.3);
}

.error-message {
    color: #ff6b6b;
    font-size: 0.9em;
    text-align: center;
}

.primary-btn {
    padding: 12px 24px;
    background: linear-gradient(135deg, #a855f7, #00d4ff);
    border: none;
    border-radius: 8px;
    color: #fff;
    font-size: 1em;
    font-weight: bold;
    cursor: pointer;
    transition: transform 0.2s, box-shadow 0.2s;
}

.primary-btn:hover {
    transform: scale(1.02);
    box-shadow: 0 5px 20px rgba(168, 85, 247, 0.4);
}

.secondary-btn {
    padding: 10px 20px;
    background: rgba(100, 100, 100, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 8px;
    color: rgba(255, 255, 255, 0.8);
    cursor: pointer;
    transition: all 0.2s;
}

.secondary-btn:hover {
    background: rgba(100, 100, 100, 0.5);
}

/* 閹村潡妫跨粵澶婄窡瀵湱鐛?*/
.room-waiting-content {
    max-width: 500px;
    width: 90%;
}

.room-code-display {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-left: auto;
}

#display-room-code {
    font-family: monospace;
    font-size: 1.2em;
    font-weight: bold;
    color: #00d4ff;
    letter-spacing: 3px;
    padding: 5px 12px;
    background: rgba(0, 212, 255, 0.1);
    border-radius: 6px;
}

.copy-btn {
    padding: 5px 10px;
    background: rgba(0, 212, 255, 0.2);
    border: 1px solid rgba(0, 212, 255, 0.3);
    border-radius: 5px;
    color: #00d4ff;
    font-size: 0.85em;
    cursor: pointer;
    transition: all 0.2s;
}

.copy-btn:hover {
    background: rgba(0, 212, 255, 0.3);
}

.room-waiting-body {
    padding: 25px;
}

.players-display {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 20px;
    margin-bottom: 25px;
}

.player-card {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    padding: 20px;
    background: rgba(40, 40, 80, 0.5);
    border-radius: 15px;
    border: 2px solid transparent;
    min-width: 120px;
    transition: all 0.3s;
}

.player-card.host {
    border-color: rgba(0, 0, 0, 0.5);
}

.player-card.guest {
    border-color: rgba(255, 255, 255, 0.3);
}

.player-card.ready {
    border-color: #00ff88;
    box-shadow: 0 0 20px rgba(0, 255, 136, 0.3);
}

.player-avatar {
    font-size: 2.5em;
}

.player-name {
    font-weight: bold;
    color: #fff;
    max-width: 100px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.player-color {
    font-size: 0.8em;
    color: rgba(255, 255, 255, 0.6);
    padding: 3px 10px;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 10px;
}

.player-status {
    font-size: 0.85em;
    padding: 4px 12px;
    border-radius: 12px;
    background: rgba(100, 100, 100, 0.3);
    color: rgba(255, 255, 255, 0.7);
}

.player-status.ready {
    background: rgba(0, 255, 136, 0.2);
    color: #00ff88;
}

.vs-divider {
    font-size: 1.5em;
    font-weight: bold;
    color: rgba(255, 255, 255, 0.3);
}

.room-actions {
    display: flex;
    gap: 15px;
    justify-content: center;
    margin-bottom: 15px;
}

.ready-btn {
    padding: 12px 40px;
    background: linear-gradient(135deg, #00d4ff, #00ff88);
    border: none;
    border-radius: 8px;
    color: #000;
    font-size: 1.1em;
    font-weight: bold;
    cursor: pointer;
    transition: transform 0.2s, box-shadow 0.2s;
}

.ready-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 5px 25px rgba(0, 212, 255, 0.4);
}

.ready-btn.is-ready {
    background: linear-gradient(135deg, #ff6b6b, #ff8e53);
}

.room-message {
    text-align: center;
    font-size: 0.9em;
    color: rgba(255, 255, 255, 0.6);
    min-height: 20px;
}

.matchmaking-content {
    max-width: 350px;
    width: 90%;
    text-align: center;
    padding: 40px 30px;
}

.matchmaking-animation {
    margin-bottom: 25px;
}

.searching-spinner {
    width: 60px;
    height: 60px;
    margin: 0 auto 20px;
    border: 4px solid rgba(168, 85, 247, 0.2);
    border-top: 4px solid #a855f7;
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

@keyframes spin {
    0% {
        transform: rotate(0deg);
    }

    100% {
        transform: rotate(360deg);
    }
}

.searching-text {
    font-size: 1.2em;
    color: #fff;
}

.matchmaking-timer {
    font-size: 2em;
    font-family: monospace;
    color: #00d4ff;
    margin-bottom: 25px;
}

/* ============ 鏄电О璁剧疆寮圭獥 ============ */
.name-setup-content {
    max-width: 400px;
    text-align: center;
}

.name-setup-hint {
    color: var(--color-primary-light);
    margin-bottom: 20px;
    font-size: 0.9em;
}

.name-input-wrapper {
    position: relative;
    margin-bottom: 15px;
}

.name-input-wrapper input {
    width: 100%;
    padding: 12px 50px 12px 15px;
    border: 2px solid var(--color-primary);
    border-radius: 8px;
    background: rgba(255, 255, 255, 0.1);
    color: var(--color-text);
    font-size: 1.1em;
    text-align: center;
}

.name-input-wrapper input:focus {
    outline: none;
    border-color: var(--color-primary-light);
    box-shadow: 0 0 10px rgba(168, 85, 247, 0.3);
}

#name-char-count {
    position: absolute;
    right: 12px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--color-text-muted);
    font-size: 0.85em;
}

.random-name-buttons {
    display: flex;
    gap: 10px;
    justify-content: center;
    margin-bottom: 15px;
}

.random-btn {
    padding: 8px 16px;
    font-size: 0.9em;
    background: linear-gradient(135deg, #4f46e5, #7c3aed);
}

.random-btn:hover {
    transform: scale(1.05);
}

.name-status {
    min-height: 24px;
    margin-bottom: 10px;
    font-size: 0.9em;
}

.name-status.error {
    color: #ef4444;
}

.name-status.success {
    color: #10b981;
}

.name-status.checking {
    color: #fbbf24;
}

.name-suggestions {
    background: rgba(255, 255, 255, 0.05);
    padding: 12px;
    border-radius: 8px;
    margin-bottom: 15px;
}

.name-suggestions p {
    margin-bottom: 8px;
    color: var(--color-text-muted);
}

#suggestion-list {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    justify-content: center;
}

.suggestion-btn {
    padding: 6px 12px;
    border: 1px solid var(--color-primary);
    border-radius: 20px;
    background: transparent;
    color: var(--color-primary-light);
    cursor: pointer;
    font-size: 0.85em;
    transition: all 0.2s;
}

.suggestion-btn:hover {
    background: var(--color-primary);
    color: white;
}

.primary-btn {
    width: 100%;
    padding: 12px;
    font-size: 1.1em;
    background: linear-gradient(135deg, #10b981, #059669);
}

.primary-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

/* ============ 澶村儚閫夋嫨鍣?============ */
.avatar-section {
    margin: 20px 0;
    padding-top: 15px;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.avatar-section label {
    display: block;
    color: var(--color-primary-light);
    margin-bottom: 10px;
}

.avatar-preview-row {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    margin-bottom: 15px;
}

.avatar-preview {
    font-size: 3em;
    width: 70px;
    height: 70px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(168, 85, 247, 0.2);
    border: 3px solid var(--color-primary);
    border-radius: 50%;
}

.avatar-preview-label {
    color: var(--color-text-muted);
    font-size: 0.9em;
}

/* Personal Center Stats Grid */
.pc-stats-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 15px;
    width: 100%;
}

.pc-stat-card {
    background: rgba(30, 30, 45, 0.6);
    border-radius: 16px;
    padding: 15px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    border: 1px solid rgba(255, 255, 255, 0.05);
    position: relative;
    /* transition: transform 0.2s; */
}

/* New Full Width Card */
.pc-stat-card.full-width {
    grid-column: span 2;
    align-items: flex-start;
    /* Align title to left */
    justify-content: flex-start;
    padding-bottom: 5px;
    /* Adjust for chart */
}

.avatar-grid {
    display: grid;
    grid-template-columns: repeat(6, 1fr);
    gap: 8px;
    padding: 10px;
    background: rgba(0, 0, 0, 0.2);
    border-radius: 12px;
}

.avatar-option {
    width: 45px;
    height: 45px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(255, 255, 255, 0.1);
    border: 2px solid transparent;
    border-radius: 50%;
    cursor: pointer;
    transition: all 0.2s;
}

.avatar-option:hover {
    background: rgba(168, 85, 247, 0.3);
    transform: scale(1.1);
}

.avatar-option.selected {
    border-color: var(--color-primary);
    background: rgba(168, 85, 247, 0.4);
    box-shadow: 0 0 10px rgba(168, 85, 247, 0.5);
}

.avatar-emoji {
    font-size: 1.5em;
}

/* ============ 鎴樼哗椤靛ご鍍忛€夋嫨鍣?============ */
.player-avatar.clickable {
    cursor: pointer;
    transition: transform 0.2s, box-shadow 0.2s;
}

.player-avatar.clickable:hover {
    transform: scale(1.1);
    box-shadow: 0 0 15px rgba(168, 85, 247, 0.5);
}

.avatar-selector-panel {
    background: rgba(0, 0, 0, 0.3);
    padding: 15px;
    border-radius: 12px;
    margin-top: 15px;
    text-align: center;
}

.avatar-selector-panel.hidden {
    display: none;
}

.avatar-selector-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
}

.avatar-selector-header h3 {
    color: #fff;
    font-size: 16px;
    margin: 0;
}

.avatar-selector-header .close-btn {
    background: none;
    border: none;
    color: rgba(255, 255, 255, 0.6);
    cursor: pointer;
    font-size: 18px;
}

.avatar-selector-title {
    color: var(--color-primary-light);
    margin-bottom: 12px;
    font-size: 0.95em;
}

.avatar-selector-panel .avatar-grid {
    margin-bottom: 12px;
}

.avatar-selector-panel .btn {
    padding: 8px 20px;
    font-size: 0.9em;
}

/* ============ 娓告垙鍐匟DU澶村儚 ============ */
.player-avatar-mini {
    font-size: 1.4em;
    margin-right: 6px;
    display: inline-block;
}

.player-container {
    display: flex;
    align-items: center;
    justify-content: center;
}

/* ============ 鎴樼哗椤靛弻杞ㄥ埗閲嶆瀯 ============ */

/* 鏂扮増澶撮儴 */
.stats-header-new {
    margin-bottom: 25px;
    padding-bottom: 15px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.player-identity {
    display: flex;
    align-items: center;
    gap: 20px;
}

.player-text {
    flex: 1;
}

.name-row {
    display: flex;
    align-items: center;
    gap: 10px;
}

.player-name-large {
    font-size: 1.8em;
    font-weight: bold;
    color: var(--text-primary);
}

.rename-btn-s {
    background: none;
    border: none;
    cursor: pointer;
    font-size: 1.2em;
    opacity: 0.6;
    transition: opacity 0.3s;
}

.rename-btn-s:hover {
    opacity: 1;
}

.uid-row {
    font-size: 0.9em;
    color: var(--text-secondary);
    margin-top: 4px;
}

/* 鍙岃建缃戞牸甯冨眬 */
.stats-dual-track {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-bottom: 20px;
}

/* 杞ㄩ亾鍗＄墖閫氱敤 */
.track-card {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    padding: 20px;
    display: flex;
    flex-direction: column;
    position: relative;
    overflow: hidden;
    transition: transform 0.3s, box-shadow 0.3s;
}

.track-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
}

.track-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 15px;
    font-size: 1.1em;
    font-weight: bold;
    color: var(--text-secondary);
}

.track-rank-display {
    display: flex;
    align-items: center;
    gap: 15px;
    margin-bottom: 20px;
}

.rank-icon-large {
    font-size: 3.5em;
    filter: drop-shadow(0 0 10px rgba(0, 0, 0, 0.3));
}

.rank-info {
    display: flex;
    flex-direction: column;
}

/* 浼犲涔嬭矾鐗瑰畾鏍峰紡 */
.track-story {
    border: 1px solid rgba(255, 215, 0, 0.1);
    background: linear-gradient(135deg, rgba(60, 40, 0, 0.3) 0%, rgba(30, 30, 30, 0.3) 100%);
}

.track-story .rank-name {
    font-size: 1.4em;
    font-weight: bold;
    color: #ffd700;
}

.track-story .rank-progress-text {
    font-size: 0.9em;
    color: rgba(255, 215, 0, 0.7);
}

/* 绔炴妧宸呭嘲鐗瑰畾鏍峰紡 */
.track-competitive {
    border: 1px solid rgba(0, 212, 255, 0.1);
    background: linear-gradient(135deg, rgba(0, 40, 60, 0.3) 0%, rgba(30, 30, 30, 0.3) 100%);
}

.track-competitive .elo-value {
    font-family: 'Roboto Mono', monospace;
    font-size: 1.8em;
    font-weight: bold;
    color: #00d4ff;
    line-height: 1;
}

.track-competitive .rank-name {
    font-size: 0.9em;
    color: rgba(0, 212, 255, 0.7);
    margin-top: 4px;
}

/* 缁熻鏁版嵁琛?*/
.track-stats {
    display: flex;
    justify-content: space-around;
    margin-bottom: 15px;
    background: rgba(0, 0, 0, 0.2);
    padding: 10px;
    border-radius: 8px;
}

.stat-item {
    text-align: center;
}

.stat-val {
    font-weight: bold;
    font-size: 1.1em;
}

.stat-label {
    font-size: 0.8em;
    color: var(--text-secondary);
}

/* 搴曢儴鍖哄煙 */
.track-footer {
    margin-top: auto;
}

/* 鍘嗗彶璁板綍棰勮 */
.match-history-preview {
    font-size: 0.8em;
    max-height: 60px;
    overflow-y: auto;
}

.history-item {
    display: flex;
    justify-content: space-between;
    padding: 3px 0;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
}

.history-item.win {
    color: var(--color-success);
}

.history-item.lose {
    color: var(--color-error);
}

.history-change {
    opacity: 0.8;
}

.empty-history {
    color: var(--text-secondary);
    font-style: italic;
    text-align: center;
    padding: 10px 0;
}

/* 鏉傞」缁熻 */
.stats-misc {
    text-align: center;
    font-size: 0.9em;
    color: var(--text-secondary);
    margin-top: 10px;
    padding-top: 10px;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.misc-divider {
    margin: 0 10px;
    opacity: 0.3;
}

/* ============ 鎴樼哗椤?UI 浼樺寲琛ヤ竵 ============ */

/* 1. 淇娈典綅鍚嶇О鎹㈣闂 */
.track-story .rank-name {
    font-size: 1.3em;
    /* 绋嶅井璋冨皬 */
    white-space: nowrap;
    /* 绂佹鎹㈣ */
    margin-bottom: 5px;
}

/* 2. 浼樺寲鍗＄墖鍐呴儴闂磋窛 */
.track-rank-display {
    justify-content: center;
    /* 灞呬腑瀵归綈 */
    margin: 25px 0;
    /* 澧炲姞涓婁笅闂磋窛 */
}

/* 3. 浼樺寲鏁板瓧瀛椾綋 */
.stat-val,
.elo-value,
.total-games {
    font-family: 'Roboto Mono', 'Consolas', monospace;
    /* 浣跨敤绛夊瀛椾綋 */
    letter-spacing: -0.5px;
}

/* 4. 璋冩暣澶撮儴甯冨眬缁嗚妭 */
.player-identity {
    padding: 0 10px;
}

.uid-row {
    font-family: monospace;
    opacity: 0.5;
}

/* 5. 绔炴妧鍦?Elo 鏄剧ず浼樺寲 */
.track-competitive .rank-info {
    align-items: flex-start;
    /* 宸﹀榻?*/
    margin-left: 10px;
}

.track-competitive .elo-value {
    font-size: 2.2em;
    /* 鍔犲ぇ鍒嗘暟 */
    text-shadow: 0 0 10px rgba(0, 212, 255, 0.3);
}

/* 6. 缁熻鏁版嵁鐩掑瓙鐨勮瑙変紭鍖?*/
.track-stats {
    background: rgba(0, 0, 0, 0.25);
    border: 1px solid rgba(255, 255, 255, 0.05);
    padding: 15px 10px;
    margin-bottom: 20px;
}

/* 7. 鍘嗗彶璁板綍鍒楄〃浼樺寲 */
.match-history-preview {
    background: rgba(0, 0, 0, 0.1);
    border-radius: 4px;
    padding: 5px 10px;
    max-height: 80px;
    /* 绋嶅井澧為珮 */
}

/* 8. 淇 UID 宸﹀榻?*/
.player-text {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    /* 寮哄埗宸﹀榻?*/
    justify-content: center;
}

/* 9. 绔炴妧鍦哄簳閮ㄥ竷灞€浼樺寲 */
.track-footer .progress-bar-container {
    height: 6px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 3px;
    margin-bottom: 8px;
    overflow: hidden;
}

.track-footer .progress-bar {
    height: 100%;
    border-radius: 3px;
    transition: width 0.5s ease;
}

/* 绔炴妧鍦鸿繘搴︽潯棰滆壊 */
#comp-progress-bar {
    background: linear-gradient(90deg, #00d4ff, #007bff);
    box-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
}

.next-rank-tip {
    font-size: 0.8em;
    color: var(--text-secondary);
    text-align: right;
    margin-bottom: 10px;
}

/* 10. 绔炴妧宸呭嘲鍗＄墖搴曢儴閲嶆瀯 (v2) */
.track-competitive .track-footer {
    padding-top: 15px;
    border-top: 1px solid rgba(255, 255, 255, 0.05);
    margin-top: 10px;
}

/* 杩涘害鏉″鍣ㄤ紭鍖?*/
.track-footer .progress-bar-container {
    height: 8px;
    /* 绋嶅井鍔犻珮 */
    background: rgba(0, 0, 0, 0.4);
    /* 鏇存繁鐨勫簳鑹?*/
    border-radius: 4px;
    margin-bottom: 10px;
    box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.3);
}

/* 涓嬩竴娈典綅鎻愮ず浼樺寲 */
.next-rank-tip {
    font-size: 0.9em;
    color: rgba(255, 255, 255, 0.8);
    text-align: center;
    /* 灞呬腑鏄剧ず */
    font-weight: 500;
    letter-spacing: 0.5px;
}

/* 杩涘害鏉″姩鐢讳笌鍏夋晥 */
#comp-progress-bar {
    position: relative;
    overflow: hidden;
}

#comp-progress-bar::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(90deg,
            rgba(255, 255, 255, 0) 0%,
            rgba(255, 255, 255, 0.3) 50%,
            rgba(255, 255, 255, 0) 100%);
    transform: skewX(-20deg) translateX(-150%);
    animation: shimmer 2s infinite;
}

@keyframes shimmer {
    0% {
        transform: skewX(-20deg) translateX(-150%);
    }

    100% {
        transform: skewX(-20deg) translateX(150%);
    }
}

/* ============ 缁撶畻鍔ㄦ晥浼樺寲 ============ */

/* 1. 寮圭獥鍐呭瀹瑰櫒 */
.winner-message {
    font-size: 1.5em;
    margin: 15px 0 25px 0;
    line-height: 1.4;
    text-align: center;
}

/* 2. 缁撶畻淇℃伅鍖哄煙 */
.settlement-container {
    background: rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    padding: 20px;
    margin: 0 auto 25px auto;
    width: 90%;
    max-width: 350px;
    box-sizing: border-box;
    opacity: 0;
    transform: translateY(10px);
    transition: all 0.5s ease-out;
}

.settlement-container.visible {
    opacity: 1;
    transform: translateY(0);
}

/* 3. 绗竴琛岋細娈典綅涓庡垎鏁?*/
.settlement-info-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
}

.settlement-rank {
    font-size: 1.2em;
    font-weight: bold;
    color: var(--text-primary);
}

.settlement-elo {
    font-family: 'Roboto Mono', monospace;
    font-size: 1.2em;
    font-weight: bold;
    color: #4cd964;
    text-shadow: 0 0 5px rgba(76, 217, 100, 0.4);
}

.settlement-elo.lose {
    color: #ff3b30;
    text-shadow: 0 0 5px rgba(255, 59, 48, 0.4);
}

/* 4. 杩涘害鏉¤儗鏅?*/
.settlement-bar-bg {
    height: 12px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 6px;
    overflow: hidden;
    position: relative;
    box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.5);
}

/* 5. 杩涘害鏉″～鍏?(甯﹀姩鐢? */
.settlement-bar-fill {
    height: 100%;
    background: linear-gradient(90deg, #ffd700, #ffaa00);
    /* 榛樿閲戣壊 */
    width: 0%;
    border-radius: 6px;
    transition: width 1.5s cubic-bezier(0.22, 1, 0.36, 1);
    position: relative;
    overflow: hidden;
}

/* 鑳滃埄鏃剁殑钃濊壊杩涘害鏉?*/
.win .settlement-bar-fill {
    background: linear-gradient(90deg, #00d4ff, #007bff);
    box-shadow: 0 0 10px rgba(0, 212, 255, 0.4);
}

/* 杩涘害鏉℃祦鍏夌壒鏁?*/
.settlement-bar-fill::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    right: 0;
    background: linear-gradient(90deg,
            rgba(255, 255, 255, 0) 0%,
            rgba(255, 255, 255, 0.4) 50%,
            rgba(255, 255, 255, 0) 100%);
    transform: skewX(-20deg) translateX(-150%);
    animation: barShimmer 2s infinite;
}

@keyframes barShimmer {
    0% {
        transform: skewX(-20deg) translateX(-150%);
    }

    100% {
        transform: skewX(-20deg) translateX(150%);
    }
}

/* 6. 搴曢儴鎻愮ず璇?*/
.settlement-tip {
    font-size: 0.85em;
    color: var(--text-secondary);
    text-align: right;
    margin-top: 8px;
    opacity: 0.8;
}

/* ============ 鏈€缁堢編鍖栬ˉ涓?(Premium Polish) ============ */

/* 1. 鏍囬涓庡壇鏍囬浼樺寲 */
#winner-title {
    font-size: 2em;
    margin-bottom: 5px;
    background: linear-gradient(to right, #fff, #bbb);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    text-align: center;
}

.winner-message {
    font-size: 1.8em;
    /* 鍔犲ぇ */
    margin: 10px 0 30px 0;
    font-weight: bold;
    text-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
    letter-spacing: 1px;
}

/* 2. 缁撶畻鍗＄墖锛氭瘺鐜荤拑鎷熸€?*/
.settlement-container {
    background: rgba(255, 255, 255, 0.08);
    /* 鏇翠寒涓€鐐?*/
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.15);
    box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
    padding: 25px;
    border-radius: 16px;
    margin-bottom: 30px;
    transform: translateY(0) scale(1);
    /* 榛樿鎬?*/
}

/* 3. 鏁版嵁琛屼紭鍖?*/
.settlement-info-row {
    margin-bottom: 15px;
    align-items: baseline;
    /* 鍩虹嚎瀵归綈 */
}

.settlement-rank {
    font-size: 1.4em;
    color: #fff;
    text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
}

.settlement-elo {
    font-size: 1.6em;
    /* 鏁板瓧鏇村ぇ */
    font-family: 'Roboto Mono', monospace;
}

/* 4. 鎸夐挳缁勪紭鍖栵細宸﹀彸骞舵帓 */
.modal-buttons {
    display: flex;
    gap: 15px;
    justify-content: center;
    width: 100%;
}

.modal-buttons .btn {
    flex: 1;
    /* 绛夊 */
    max-width: 160px;
    padding: 12px 0;
    font-size: 1.1em;
    border-radius: 25px;
    /* 鍦嗚鏇村ぇ */
    text-align: center;
    transition: transform 0.2s, box-shadow 0.2s;
}

.modal-buttons .btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
}

/* 涓昏鎸夐挳 (鍐嶆潵涓€灞€) */
.primary-btn {
    background: linear-gradient(135deg, #00d4ff 0%, #007bff 100%);
    border: none;
    color: white;
    box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
}

/* 娆¤鎸夐挳 (杩斿洖鑿滃崟) */
.secondary-btn {
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: rgba(255, 255, 255, 0.8);
}

.secondary-btn:hover {
    background: rgba(255, 255, 255, 0.15);
    color: white;
}

/* 5. 鎻愮ず璇紭鍖?*/
.settlement-tip {
    font-size: 0.9em;
    opacity: 0.6;
    text-align: center;
    /* 灞呬腑 */
    margin-top: 12px;
}

/* ============ 椤堕儴甯冨眬浼樺寲 (Header Optimization) ============ */
.header-main-layout {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    /* 鍑忓皬闂磋窛 */
    margin-bottom: 10px;
    width: 100%;
}

/* 鐜╁淇℃伅琛?- 鏇村姞绱у噾 */
.header-main-layout .player-info {
    display: flex;
    /* 纭繚 Flex 甯冨眬 */
    margin-bottom: 5px;
    /* 鍑忓皬搴曢儴杈硅窛 */
}

/* 鐘舵€佽锛氬洖鍚?+ 鍊掕鏃跺苟鎺掓樉绀?*/
.game-status-row {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 15px;
    /* 涓や釜鍏冪礌涔嬮棿鐨勯棿璺?*/
    width: 100%;
}

/* 璋冩暣鍚庣殑鍥炲悎鏄剧ず */
.header-main-layout .current-turn {
    margin-top: 0;
    padding: 6px 15px;
    /* 绋嶅井鍑忓皬鍐呰竟璺?*/
    font-size: 1.1em;
    background: rgba(0, 0, 0, 0.4);
    /* 鏇存繁鐨勮儗鏅鍔犲姣斿害 */
    backdrop-filter: blur(5px);
    border: 1px solid rgba(255, 255, 255, 0.1);
}

/* 璋冩暣鍚庣殑璁℃椂鍣ㄦ樉绀?*/
.header-main-layout .game-timer {
    margin-top: 0;
    padding: 6px 15px;
    font-size: 1.2em;
    /* 绋嶅井璋冨皬浠ュ尮閰?*/
    border: 1px solid rgba(255, 215, 0, 0.3);
    background: rgba(0, 0, 0, 0.4);
}

/* 娓告垙妯″紡鏄剧ず - 缂╁皬骞朵笉鍗犵敤澶绌洪棿 */
.header-main-layout .game-mode-display {
    margin-top: 2px;
    font-size: 0.9em;
    opacity: 0.8;
}

/* 鏁呬簨妯″紡涓嬮殣钘忛€氱敤 Header (鐢盝S鎺у埗鏄鹃殣锛屼絾CSS涔熷仛鍏滃簳) */
.story-hud:not(.hidden)~.header-main-layout {
    display: none;
}

/* ============ Soul Duel Header (Avatar-Centric) ============ */
.soul-header-layout {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    margin-bottom: 5px;
    padding: 0 10px;
    box-sizing: border-box;
    position: relative;
    z-index: 10;
}

.soul-card {
    display: flex;
    align-items: center;
    gap: 12px;
    transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    /* 寮规€у姩鏁?*/
    opacity: 0.6;
    /* 榛樿鏈縺娲荤姸鎬佸崐閫忔槑 */
    transform: scale(0.9);
    filter: grayscale(0.3);
}

.soul-card.active {
    opacity: 1;
    transform: scale(1.05);
    filter: grayscale(0);
}

.soul-card.left {
    flex-direction: row;
}

.soul-card.right {
    flex-direction: row-reverse;
    text-align: right;
}

/* 澶村儚瀹瑰櫒 */
.soul-avatar-container {
    position: relative;
    width: 68px;
    /* 澧炲姞灏哄 */
    height: 68px;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
}

/* 鍊掕鏃?SVG 鍏夌幆 */
.soul-ring-svg {
    position: absolute;
    top: -6px;
    left: -6px;
    width: 80px;
    height: 80px;
    transform: rotate(-90deg);
    /* 浠庨《閮ㄥ紑濮?*/
    pointer-events: none;
}

.soul-ring-bg {
    fill: none;
    stroke: rgba(255, 255, 255, 0.1);
    stroke-width: 4;
}

.soul-ring-progress {
    fill: none;
    stroke: #ffd700;
    /* 榛樿閲戣壊 */
    stroke-width: 4;
    stroke-linecap: round;
    stroke-dasharray: 289;
    /* 2 * PI * 46  289 */
    stroke-dashoffset: 0;
    transition: stroke-dashoffset 1s linear, stroke 0.3s;
}

/* 绱ф€ョ姸鎬?(鏈€鍚?绉? */
.soul-card.urgent .soul-ring-progress {
    stroke: #ff3b30;
    filter: drop-shadow(0 0 5px #ff3b30);
}

.soul-card.urgent .soul-avatar-container {
    animation: urgentShake 0.5s infinite;
}

@keyframes urgentShake {

    0%,
    100% {
        transform: translateX(0);
    }

    25% {
        transform: translateX(-2px);
    }

    75% {
        transform: translateX(2px);
    }
}

/* 澶村儚 Emoji */
.soul-avatar-emoji {
    font-size: 42px;
    z-index: 2;
    filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.3));
    transition: transform 0.2s;
}

/* 鐐瑰嚮鍙嶉 */
.soul-avatar-container:active .soul-avatar-emoji {
    transform: scale(0.9);
}

/* 妫嬪瓙鐘舵€佽鏍?*/
.soul-status-icon {
    position: absolute;
    bottom: -2px;
    right: -2px;
    width: 24px;
    height: 24px;
    background: rgba(0, 0, 0, 0.6);
    border-radius: 50%;
    color: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 14px;
    z-index: 3;
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.soul-card.left .soul-status-icon {
    right: -2px;
}

.soul-card.right .soul-status-icon {
    left: -2px;
    right: auto;
}

/* 鐜╁淇℃伅鏂囨湰 */
.soul-info {
    display: flex;
    flex-direction: column;
    justify-content: center;
}

.soul-name {
    font-size: 1.1em;
    font-weight: bold;
    color: white;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
    margin-bottom: 2px;
}

.soul-elo {
    font-family: 'Roboto Mono', monospace;
    font-size: 0.9em;
    color: #ffd700;
    /* 閲戣壊 */
    opacity: 0.9;
}

/* 婵€娲绘€佸厜鏁堝寮?*/
.soul-card.active .soul-avatar-emoji {
    filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.6));
}

/* 璁℃椂鍣ㄦ暟瀛?*/
.soul-timer {
    font-family: 'Roboto Mono', monospace;
    /* 绛夊瀛椾綋闃叉璺冲姩 */
    font-size: 1.2em;
    font-weight: bold;
    color: #fff;
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.8);
    margin-top: 4px;
    background: rgba(0, 0, 0, 0.3);
    padding: 2px 8px;
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: color 0.3s, background 0.3s;
}

/* 璁℃椂鍣ㄤ綆鐢甸噺璀﹀憡 */
.soul-timer.low-time {
    color: #ff4444;
    background: rgba(50, 0, 0, 0.5);
    border-color: #ff4444;
    animation: timerPulse 1s infinite;
}

@keyframes timerPulse {
    0% {
        transform: scale(1);
        opacity: 1;
    }

    50% {
        transform: scale(1.05);
        opacity: 0.8;
    }

    100% {
        transform: scale(1);
        opacity: 1;
    }
}

/* ============ 修复后的聊天气泡样式 (Chat Bubble Fixes) ============ */
.chat-bubble {
    position: absolute;
    top: -50px;
    left: 50%;
    transform: translateX(-50%) scale(0);
    background: #fff;
    color: #333;
    padding: 8px 12px;
    border-radius: 12px;
    font-size: 14px;
    font-weight: bold;
    white-space: nowrap;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    z-index: 100;
    pointer-events: none;
    opacity: 0;
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.chat-bubble::after {
    content: '';
    position: absolute;
    bottom: -6px;
    left: 50%;
    transform: translateX(-50%);
    border-width: 6px 6px 0;
    border-style: solid;
    border-color: #fff transparent transparent transparent;
}

.chat-bubble.visible {
    transform: translateX(-50%) scale(1);
    opacity: 1;
    top: -60px;
}

.chat-bubble.fade-out {
    opacity: 0;
    transform: translateX(-50%) scale(0.8) translateY(-10px);
}

.chat-wrapper {
    position: relative;
    display: inline-block;
}

.chat-panel {
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%);
    width: 200px;
    background: rgba(30, 30, 50, 0.95);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 10px;
    padding: 10px;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 8px;
    box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
    z-index: 200;
    margin-bottom: 10px;
    backdrop-filter: blur(5px);
}

.chat-option {
    background: rgba(255, 255, 255, 0.1);
    border: none;
    color: #fff;
    padding: 8px;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.2s;
    font-size: 13px;
}

.chat-option:hover {
    background: rgba(0, 212, 255, 0.3);
    transform: scale(1.05);
}

.chat-panel.hidden {
    display: none;
}

/* ============ 布局修复补丁 (Layout Fixes) ============ */

/* 1. 解决 Logo 遮挡问题：下移 Avatar Header */
.soul-header-layout {
    margin-top: 50px;
    /* 避开顶部的 Logo 和 按钮 */
    position: relative;
    z-index: 20;
    /* 确保在 Logo 之上 */
    padding: 0 20px;
}

/* 2. 确保计时器可见性 */
.soul-timer {
    display: block !important;
    /* 强制显示 */
    background: rgba(0, 0, 0, 0.6);
    /* 加深背景 */
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
    z-index: 100;
    margin-top: 6px;
    letter-spacing: 1px;
}

/* 3. 增强 Soul Avatar 区域 */
.soul-avatar-container {
    background: rgba(0, 0, 0, 0.2);
    border-radius: 50%;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
}

/* 4. 尝试隐藏默认 H1 (如果是它在干扰) */
body.online-game h1,
body.online-game .game-title {
    opacity: 0.2;
    /* 在联机模式下淡化标题 */
    transform: scale(0.8);
    pointer-events: none;
}

/* ============ 最终美化补丁 (Premium Polish) - 结算画面 ============ */

/* 1. 标题与副标题优化 */
#winner-title {
    font-size: 2em;
    margin-bottom: 5px;
    background: linear-gradient(to right, #fff, #bbb);
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
    text-align: center;
    font-weight: 900;
    letter-spacing: 2px;
}

.winner-message {
    font-size: 1.8em;
    margin: 10px 0 30px 0;
    font-weight: bold;
    text-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
    letter-spacing: 1px;
    text-align: center;
}

/* 2. 结算卡片：毛玻璃拟态 */
.settlement-container {
    background: rgba(255, 255, 255, 0.08);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.15);
    box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
    padding: 25px;
    border-radius: 16px;
    margin-bottom: 30px;
    transform: translateY(10px);
    opacity: 0;
    transition: all 0.5s ease-out;
}

.settlement-container.visible {
    opacity: 1;
    transform: translateY(0);
}

/* 3. 第一行：段位与分数 */
.settlement-info-row {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    margin-bottom: 15px;
}

.settlement-rank {
    font-size: 1.4em;
    color: #fff;
    font-weight: bold;
    text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
}

.settlement-elo {
    font-family: 'Roboto Mono', monospace;
    font-size: 1.6em;
    font-weight: bold;
    color: #4cd964;
    text-shadow: 0 0 5px rgba(76, 217, 100, 0.4);
}

/* 4. 进度条背景 */
.settlement-bar-bg {
    height: 12px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 6px;
    overflow: hidden;
    position: relative;
    box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.5);
}

/* 5. 进度条填充 (带动画) */
.settlement-bar-fill {
    height: 100%;
    background: linear-gradient(90deg, #ffd700, #ffaa00);
    width: 0%;
    border-radius: 6px;
    transition: width 1.5s cubic-bezier(0.22, 1, 0.36, 1);
    position: relative;
    overflow: hidden;
    box-shadow: 0 0 10px rgba(255, 215, 0, 0.4);
}

.win .settlement-bar-fill {
    background: linear-gradient(90deg, #00d4ff, #007bff);
    box-shadow: 0 0 10px rgba(0, 212, 255, 0.4);
}

/* 进度条流光特效 */
.settlement-bar-fill::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    right: 0;
    background: linear-gradient(90deg,
            rgba(255, 255, 255, 0) 0%,
            rgba(255, 255, 255, 0.4) 50%,
            rgba(255, 255, 255, 0) 100%);
    transform: skewX(-20deg) translateX(-150%);
    animation: barShimmer 2s infinite;
}

@keyframes barShimmer {
    0% {
        transform: skewX(-20deg) translateX(-150%);
    }

    100% {
        transform: skewX(-20deg) translateX(150%);
    }
}

/* 6. 底部提示语 */
.settlement-tip {
    font-size: 0.9em;
    color: var(--text-secondary);
    text-align: center;
    margin-top: 12px;
    opacity: 0.8;
}

/* 7. 按钮组优化：左右并排 */
.modal-buttons {
    display: flex;
    gap: 15px;
    justify-content: center;
    width: 100%;
}

.modal-buttons .btn {
    flex: 1;
    max-width: 160px;
    padding: 12px 0;
    font-size: 1.1em;
    border-radius: 25px;
    text-align: center;
    transition: transform 0.2s, box-shadow 0.2s;
    cursor: pointer;
}

.modal-buttons .btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
}

/* 主要按钮 (再来一局) */
.primary-btn {
    background: linear-gradient(135deg, #00d4ff 0%, #007bff 100%);
    border: none;
    color: white;
    box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
}

/* 次要按钮 (返回菜单) */
.secondary-btn {
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: rgba(255, 255, 255, 0.8);
}

.secondary-btn:hover {
    background: rgba(255, 255, 255, 0.15);
    color: white;
}

/* ============ 全局模态框修复 (Global Modal Fix) ============ */
.modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.85) !important;
    /* 加深背景 */
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 2000 !important;
    /* 确保层级最高 */
    transition: opacity 0.3s;
    backdrop-filter: blur(5px);
}

.modal.hidden {
    display: none !important;
}

.modal-content {
    background: #2a2a40;
    padding: 20px;
    border-radius: 15px;
    max-width: 90%;
    width: 400px;
    box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
    position: relative;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.modal-buttons .btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
}

/* 主要按钮 (再来一局) */
.primary-btn {
    background: linear-gradient(135deg, #00d4ff 0%, #007bff 100%);
    border: none;
    color: white;
    box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
}

/* 次要按钮 (返回菜单) */
.secondary-btn {
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: rgba(255, 255, 255, 0.8);
}

.secondary-btn:hover {
    color: white;
}

/* ============ Mobile Adaptation (Phase 8) ============ */
/* ============ Mobile Adaptation (Phase 8 Revised) ============ */
@media (max-width: 600px) {

    /* 1. Reset Container Layout - P0 FIX */
    .container {
        padding: 5px;
        padding-bottom: 100px;
        /* Space for fixed controls */
        width: 100vw;
        height: auto !important;
        /* P0 FIX: Override any fixed height */
        min-height: 100vh;
        overflow-x: hidden;
        overflow-y: auto;
    }


    /* 2. Header: Compact Row Layout */
    .soul-header-layout {
        position: relative;
        margin-top: 5px;
        padding: 5px 10px;
        width: 100%;
        display: flex;
        flex-direction: row;
        justify-content: space-between;
        align-items: flex-start;
        gap: 0;
        /* Remove huge gap */
        transform: none;
        /* Remove scale, use proper sizing */
    }

    /* 3. Soul Card: Compact Mode */
    .soul-card {
        width: 110px;
        /* Fixed small width */
        padding: 5px;
        background: rgba(0, 0, 0, 0.3);
        /* Darker bg for contrast */
        border-radius: 10px;
        display: flex;
        flex-direction: column;
        align-items: center;
        margin: 0;
    }

    .soul-card.p2 {
        align-items: center;
        /* Center align P2 too on mobile */
    }

    /* 4. Avatar & Ring Sizing */
    .soul-avatar-container {
        width: 45px;
        height: 45px;
        margin-bottom: 2px;
    }

    .soul-ring-svg {
        width: 55px;
        /* Strictly control size */
        height: 55px;
        top: -5px;
        left: -5px;
    }

    .soul-avatar-emoji {
        font-size: 24px;
        line-height: 45px;
    }

    /* 5. Text & Timer Sizing */
    .soul-name {
        font-size: 12px;
        margin-bottom: 2px;
        max-width: 100px;
    }

    .soul-elo {
        font-size: 10px;
        margin-bottom: 2px;
        color: #aaa;
    }

    /* The huge timer text */
    .soul-timer {
        font-size: 14px;
        padding: 2px 8px;
        margin-top: 2px;
    }

    /* 6. Winner Modal Fix (Already good, but ensure z-index) */
    .modal {
        z-index: 9999 !important;
    }

    .modal-content {
        width: 85% !important;
        max-width: 320px;
        padding: 20px 15px;
    }

    /* 7. Hide/Adjust non-essential decorative elements */
    .vs-logo {
        display: none;
        /* Hide VS logo on mobile if it takes space */
    }

    h1 {
        display: none;
        /* Hide Game Title on mobile to save space */
    }

    /* 8. Mobile Chat Bubbles (Side positioning to avoid clipping) */
    .chat-bubble {
        top: 50% !important;
        bottom: auto;
        white-space: nowrap;
        font-size: 12px;
        padding: 6px 10px;
    }

    /* Player 1 (Left) -> Bubble to Right */
    .chat-bubble.left {
        left: 120%;
        right: auto;
        transform: translateY(-50%) scale(0);
        transform-origin: left center;
    }

    .chat-bubble.left.visible {
        transform: translateY(-50%) scale(1);
    }

    /* Player 2 (Right) -> Bubble to Left */
    .chat-bubble.right {
        right: 120%;
        left: auto;
        transform: translateY(-50%) scale(0);
        transform-origin: right center;
    }

    .chat-bubble.right.visible {
        transform: translateY(-50%) scale(1);
    }

    /* Adjust Arrows for side bubbles */
    .chat-bubble::after {
        top: 50%;
        bottom: auto;
        transform: translateY(-50%);
        border-width: 5px;
    }

    .chat-bubble.left::after {
        left: -10px;
        border-color: transparent #fff transparent transparent;
    }

    .chat-bubble.right::after {
        left: auto;
        right: -10px;
        border-color: transparent transparent transparent #fff;
    }

    /* ============ P1: Game Interface Mobile Optimization ============ */

    /* Game Layout: Vertical Stack */
    .game-layout {
        flex-direction: column !important;
        align-items: center !important;
        gap: 10px !important;
        width: 100%;
        padding: 0 5px;
    }

    /* Game Container: Full Width Board */
    .game-container {
        width: 100% !important;
        max-width: 100vw !important;
        padding: 5px;
        order: 1;
    }

    #board {
        width: 100% !important;
        height: auto !important;
        aspect-ratio: 1 / 1;
        touch-action: none;
    }

    /* Character Wrapper: Horizontal Compact Bar */
    .character-wrapper {
        position: relative !important;
        width: 100% !important;
        height: auto !important;
        min-height: 70px;
        max-height: none !important;

        display: flex !important;
        flex-direction: row !important;
        align-items: center !important;
        gap: 10px;
        padding: 10px !important;

        background: rgba(15, 15, 26, 0.95) !important;
        border-radius: 12px !important;
        overflow: visible !important;
        order: 0;
    }

    .character-wrapper.hidden {
        display: none !important;
    }

    .char-frame {
        position: relative !important;
        width: 55px !important;
        height: 55px !important;
        min-width: 55px;
        flex-shrink: 0;
        border-radius: 50% !important;
        overflow: hidden;
    }

    .char-sprite {
        width: 100% !important;
        height: 100% !important;
        object-fit: cover !important;
        object-position: center top !important;
    }

    .char-name {
        position: relative !important;
        font-size: 0.85em !important;
        padding: 3px 8px !important;
        background: transparent !important;
        color: #a855f7 !important;
        white-space: nowrap;
        bottom: auto !important;
        left: auto !important;
    }

    .dialogue-box {
        position: relative !important;
        flex: 1;
        height: auto !important;
        min-height: 40px;
        padding: 8px 12px !important;
        background: rgba(0, 0, 0, 0.4) !important;
        border-radius: 8px;
        font-size: 0.8em;
        bottom: auto !important;
        left: auto !important;
        right: auto !important;
    }

    .dialogue-box p {
        margin: 0;
        text-align: left !important;
        font-size: 0.85em;
    }

    /* Fixed Bottom Controls */
    .controls {
        position: fixed !important;
        bottom: 0 !important;
        left: 0 !important;
        right: 0 !important;
        width: 100% !important;
        padding: 10px 15px;
        padding-bottom: max(10px, env(safe-area-inset-bottom));
        background: rgba(10, 16, 30, 0.98) !important;
        backdrop-filter: blur(10px);
        border-top: 1px solid rgba(255, 255, 255, 0.15);
        z-index: 200 !important;
        display: flex !important;
        justify-content: center;
        gap: 10px;
        flex-wrap: nowrap;
    }

    .controls .btn {
        flex: 1;
        max-width: none;
        padding: 12px 8px;
        font-size: 0.85em;
        border-radius: 8px;
    }

    /* Story HUD Mobile */
    .story-hud {
        flex-direction: column !important;
        gap: 8px;
        padding: 10px;
        width: 100%;
    }

    .story-hud-left,
    .story-hud-center,
    .story-hud-right {
        width: 100%;
        border-right: none !important;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        padding: 5px 0;
        text-align: center;
    }

    .story-hud-right {
        border-bottom: none;
    }

    .story-hud-title {
        font-size: 1em;
    }

    .rule-tag {
        font-size: 0.75em;
        padding: 3px 6px;
    }

    /* VFX Layer: Hidden on mobile for performance */
    .vfx-overlay {
        display: none !important;
    }

    /* ============ P1: Modal Optimizations ============ */

    /* Online Lobby Modal */
    .online-lobby-content {
        width: 95vw !important;
        max-width: 95vw !important;
        padding: 15px !important;
    }

    .lobby-options {
        flex-direction: column !important;
        gap: 10px !important;
    }

    .lobby-btn {
        width: 100% !important;
    }

    /* Room Waiting Modal */
    .room-waiting-content {
        width: 95vw !important;
        max-width: 95vw !important;
        padding: 15px !important;
    }

    .players-display {
        flex-direction: column !important;
        gap: 10px !important;
    }

    .player-card {
        width: 100% !important;
        min-width: unset !important;
    }

    .vs-divider {
        font-size: 1em;
        padding: 5px 0;
    }

    .room-actions {
        flex-direction: column !important;
        gap: 8px;
    }

    .room-actions .btn {
        width: 100% !important;
    }

    /* Join Room Modal */
    .join-room-content {
        width: 95vw !important;
        max-width: 95vw !important;
    }

    .room-code-input {
        font-size: 1.2em;
        text-align: center;
        letter-spacing: 3px;
    }

    /* Matchmaking Modal */
    .matchmaking-content {
        width: 90vw !important;
        max-width: 90vw !important;
        text-align: center;
    }

    /* AI Difficulty Modal */
    .difficulty-content {
        width: 95vw !important;
        max-width: 95vw !important;
    }

    .difficulty-options {
        flex-direction: column !important;
        gap: 10px;
    }

    .difficulty-btn {
        width: 100% !important;
    }

    /* Mission Select Modal */
    .mission-select-content {
        width: 95vw !important;
        max-width: 95vw !important;
        max-height: 85vh;
    }

    .mission-card {
        flex-direction: column !important;
    }

    .mission-thumb {
        width: 100% !important;
        height: 100px !important;
    }

    .mission-info {
        width: 100% !important;
        padding: 10px !important;
    }

    .mission-action {
        width: 100% !important;
        border-left: none !important;
        border-top: 1px solid rgba(168, 85, 247, 0.2);
    }

    /* Spectate Lobby Modal */
    .spectate-lobby-content {
        width: 95vw !important;
        min-width: unset !important;
        max-width: 95vw !important;
    }

    /* RPS Game Modal */
    .rps-content {
        width: 95vw !important;
        max-width: 95vw !important;
    }

    .rps-game {
        flex-direction: column !important;
        gap: 15px;
    }

    .rps-player {
        width: 100% !important;
    }

    .rps-btn {
        font-size: 1.5em;
        padding: 10px;
    }

    /* Winner/Game Over Modal */
    .winner-content {
        width: 90vw !important;
        max-width: 90vw !important;
        padding: 20px 15px;
    }

    /* Leaderboard Modal */
    .leaderboard-modal-content {
        width: 95vw !important;
        max-width: 95vw !important;
        max-height: 85vh;
    }

    /* Personal Center / Stats Modal */
    .personal-center-content {
        width: 95vw !important;
        max-width: 95vw !important;
        max-height: 90vh;
        overflow-y: auto;
    }

    .pc-stats-grid {
        grid-template-columns: 1fr 1fr !important;
        gap: 10px;
    }

    .pc-stat-card.full-width {
        grid-column: span 2;
    }

    /* Feedback Modal */
    .feedback-content {
        width: 95vw !important;
        max-width: 95vw !important;
    }

    .feedback-textarea {
        font-size: 16px;
        /* Prevent iOS zoom on focus */
    }

    /* Settings Modal */
    .settings-content {
        width: 95vw !important;
        max-width: 95vw !important;
    }
}


/* ========== 观战系统样式 ========== */

/* 观战大厅弹窗 */
.spectate-lobby-content {
    min-width: 700px;
    max-width: 900px;
    max-height: 80vh;
    overflow-y: auto;
}

.spectate-lobby-body {
    margin-top: 20px;
}

.spectate-status {
    text-align: center;
    margin-bottom: 20px;
    color: #aaa;
    font-size: 0.95em;
    padding: 10px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 8px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.spectate-actions {
    display: flex;
    align-items: center;
    gap: 10px;
}

.refresh-btn {
    padding: 8px 12px;
    font-size: 1.2em;
    background: linear-gradient(145deg, #2a2a5a, #1a1a4a);
    border: 1px solid rgba(0, 212, 255, 0.3);
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s;
    color: #fff;
}

.refresh-btn:hover {
    background: linear-gradient(145deg, #3a3a6a, #2a2a5a);
    box-shadow: 0 0 15px rgba(0, 212, 255, 0.4);
    transform: rotate(180deg);
}

/* 对局列表 */
.game-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 15px;
    padding: 10px;
    min-height: 200px;
}

.empty-games {
    text-align: center;
    color: #888;
    padding: 60px 20px;
    font-size: 1.1em;
    grid-column: 1 / -1;
}

/* 对局卡片 */
.game-card {
    background: linear-gradient(145deg, #252550, #1a1a40);
    border: 2px solid rgba(0, 212, 255, 0.2);
    border-radius: 12px;
    padding: 20px;
    cursor: pointer;
    transition: all 0.3s;
    position: relative;
    overflow: hidden;
}

.game-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(0, 212, 255, 0.1), transparent);
    transition: left 0.5s;
}

.game-card:hover::before {
    left: 100%;
}

.game-card:hover {
    border-color: #00d4ff;
    box-shadow: 0 0 25px rgba(0, 212, 255, 0.3);
    transform: translateY(-3px);
}

.game-card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.game-room-code {
    font-size: 0.85em;
    color: #888;
    font-family: 'Courier New', monospace;
}

.game-spectator-badge {
    display: flex;
    align-items: center;
    gap: 5px;
    padding: 4px 10px;
    background: rgba(168, 85, 247, 0.2);
    border-radius: 12px;
    font-size: 0.85em;
    color: #a855f7;
    border: 1px solid rgba(168, 85, 247, 0.3);
}

.game-players {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 15px;
    margin-bottom: 12px;
}

.game-player {
    flex: 1;
    text-align: center;
}

.game-player-avatar {
    font-size: 2em;
    margin-bottom: 5px;
}

.game-player-name {
    font-size: 1em;
    color: #fff;
    margin-bottom: 3px;
    font-weight: bold;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.game-player-elo {
    font-size: 0.85em;
    color: #aaa;
}

.game-vs {
    font-size: 1.3em;
    font-weight: bold;
    color: #ffd700;
}

.game-info-row {
    display: flex;
    justify-content: space-around;
    margin-top: 12px;
    padding-top: 12px;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.game-info-item {
    text-align: center;
}

.game-info-label {
    font-size: 0.8em;
    color: #888;
    margin-bottom: 3px;
}

.game-info-value {
    font-size: 1.1em;
    color: #fff;
    font-weight: bold;
}

.game-turn-indicator {
    display: inline-block;
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: #ffd700;
    box-shadow: 0 0 10px rgba(255, 215, 0, 0.6);
    animation: pulse 1.5s infinite;
}

/* 观战模式指示器 */
.spectating-indicator {
    position: fixed;
    top: 20px;
    right: 20px;
    padding: 10px 20px;
    background: rgba(168, 85, 247, 0.9);
    color: #fff;
    border-radius: 8px;
    font-size: 1em;
    font-weight: bold;
    z-index: 500;
    box-shadow: 0 4px 15px rgba(168, 85, 247, 0.4);
    animation: pulse 2s infinite;
    display: flex;
    align-items: center;
    gap: 8px;
}

.spectating-indicator-icon {
    font-size: 1.2em;
}

/* 观战退出按钮 */
.spectate-exit-btn {
    background: linear-gradient(145deg, #dc2626, #b91c1c);
    margin-left: 10px;
    padding: 6px 15px;
    font-size: 0.9em;
}

.spectate-exit-btn:hover {
    box-shadow: 0 0 20px rgba(220, 38, 38, 0.5);
}

/* 响应式调整 */
@media screen and (max-width: 800px) {
    .spectate-lobby-content {
        min-width: auto;
        width: 90vw;
        max-width: 100%;
    }

    .game-list {
        grid-template-columns: 1fr;
    }

    .spectating-indicator {
        top: 10px;
        right: 10px;
        font-size: 0.9em;
        padding: 8px 15px;
    }
}

/* =========================================
   Personal Center (Redesign)
   ========================================= */

/* Main Modal Content - Glassmorphism Container */
.personal-center-content {
    /* Premium Glass Background - matching main menu style */
    background: linear-gradient(145deg,
            rgba(255, 255, 255, 0.08) 0%,
            rgba(255, 255, 255, 0.02) 50%,
            rgba(0, 0, 0, 0.1) 100%), rgba(20, 24, 40, 0.85);

    backdrop-filter: blur(24px);
    -webkit-backdrop-filter: blur(24px);

    /* Premium double-border effect */
    border: 1px solid rgba(255, 255, 255, 0.15);
    border-top-color: rgba(255, 255, 255, 0.25);
    border-left-color: rgba(255, 255, 255, 0.2);

    border-radius: 24px;
    padding: 28px;
    width: 380px;
    max-width: 90vw;

    /* Enhanced shadow for depth */
    box-shadow:
        0 25px 80px rgba(0, 0, 0, 0.5),
        0 0 40px rgba(139, 92, 246, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);

    color: #fff;
    font-family: 'Inter', system-ui, sans-serif;
    display: flex;
    flex-direction: column;
    gap: 20px;
}

/* 1. Header */
.pc-header {
    display: flex;
    justify-content: center;
    /* Center title */
    align-items: center;
    position: relative;
    padding-bottom: 10px;
}

.pc-header h2 {
    font-size: 20px;
    font-weight: 700;
    margin: 0;
    background: linear-gradient(135deg, #fff 0%, #a5b4fc 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    text-shadow: 0 2px 10px rgba(165, 180, 252, 0.2);
}

.pc-header .close-btn {
    position: absolute;
    right: 0;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(255, 255, 255, 0.1);
    border: none;
    color: #fff;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    font-size: 16px;
    cursor: pointer;
    transition: all 0.2s;
}

.pc-header .close-btn:hover {
    background: rgba(255, 255, 255, 0.2);
}

/* 2. Profile Section */
.pc-profile-section {
    display: flex;
    align-items: center;
    gap: 16px;
    padding: 0 10px;
}

.pc-avatar-container {
    position: relative;
}

.pc-avatar {
    width: 72px;
    height: 72px;
    background: linear-gradient(135deg, #6366f1, #a78bfa);
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 36px;
    box-shadow:
        0 0 0 4px rgba(99, 102, 241, 0.25),
        0 8px 24px rgba(99, 102, 241, 0.3);
    /* No click/edit behavior */
}

.pc-avatar .edit-badge {
    display: none;
    /* Hidden - no avatar editing by default */
}

.pc-info-container {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 6px;
}

.pc-name-row {
    display: flex;
    align-items: center;
    gap: 8px;
}

.pc-name {
    font-size: 20px;
    font-weight: 700;
}

.pc-rename-btn {
    background: none;
    border: none;
    cursor: pointer;
    font-size: 14px;
    opacity: 0.6;
    padding: 0;
}

.pc-rank-row {
    display: flex;
    align-items: center;
    gap: 12px;
}

.pc-rank-icon {
    font-size: 24px;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
}

.pc-rank-text {
    flex: 1;
}

.pc-rank-title {
    font-size: 14px;
    font-weight: 600;
    color: #fbbf24;
    /* Amber-400 for Gold-like */
    margin-bottom: 4px;
}

.pc-rank-progress-track {
    width: 100%;
    height: 6px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 3px;
    overflow: hidden;
    position: relative;
}

.pc-rank-progress-bar {
    height: 100%;
    background: linear-gradient(90deg, #fbbf24, #f59e0b);
    border-radius: 3px;
}

.pc-rank-val {
    font-size: 10px;
    color: rgba(255, 255, 255, 0.5);
    margin-top: 2px;
    text-align: right;
}

/* 3. Stats Grid */
.pc-stats-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-template-rows: 1fr 1fr;
    gap: 12px;
}

.pc-stat-card {
    /* Premium Glass Card */
    background: linear-gradient(145deg,
            rgba(255, 255, 255, 0.06) 0%,
            rgba(255, 255, 255, 0.02) 100%);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-top-color: rgba(255, 255, 255, 0.18);
    border-radius: 16px;
    padding: 18px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    position: relative;
    overflow: hidden;
    box-shadow:
        inset 0 1px 0 rgba(255, 255, 255, 0.08),
        0 4px 12px rgba(0, 0, 0, 0.15);
    transition: all 0.2s ease;
}

.pc-stat-card:hover {
    transform: translateY(-2px);
    border-color: rgba(255, 255, 255, 0.2);
}

.pc-stat-label {
    font-size: 12px;
    color: rgba(255, 255, 255, 0.6);
    margin-bottom: 8px;
}

.pc-stat-value {
    font-size: 24px;
    font-weight: 700;
    display: flex;
    align-items: center;
    gap: 4px;
}

.pc-stat-value .icon {
    font-size: 18px;
}

/* Circular Chart */
.circular-chart {
    position: relative;
    width: 80px;
    height: 80px;
}

.circular-chart .circular-svg {
    transform: rotate(-90deg);
    width: 100%;
    height: 100%;
}

.circular-chart .circle-bg {
    fill: none;
    stroke: rgba(255, 255, 255, 0.1);
    stroke-width: 2.5;
}

.circular-chart .circle {
    fill: none;
    stroke: url(#gradient);
    stroke: #818cf8;
    /* Fallback */
    stroke-width: 2.5;
    stroke-linecap: round;
    /* stroke-dasharray set inline via JS */
    transition: stroke-dasharray 0.6s ease;
}

/* SVG Gradient trick usually needs defs, simple stroke color here or CSS conic */
/* Using Conic Gradient instead for simplicity if SVG is complex */
/* But SVG is cleaner. Let's stick to SVG stroke color. */
.circular-chart .circle {
    stroke: #6366f1;
    /* Indigo-500 */
}

.circular-chart .percentage-text {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
    display: flex;
    flex-direction: column;
}

.percentage-text .label {
    font-size: 10px;
    color: rgba(255, 255, 255, 0.5);
}

.percentage-text .value {
    font-size: 16px;
    font-weight: 700;
}

/* 4. Settings Footer */
.pc-settings-footer {
    background: rgba(0, 0, 0, 0.2);
    border-radius: 16px;
    padding: 16px;
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.setting-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 4px 0;
}

.setting-item span {
    font-size: 14px;
    color: rgba(255, 255, 255, 0.8);
}

/* IOS Toggle Switch */
.toggle-switch {
    position: relative;
    display: inline-block;
    width: 44px;
    height: 24px;
}

.toggle-switch input {
    opacity: 0;
    width: 0;
    height: 0;
}

.slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(255, 255, 255, 0.2);
    transition: .4s;
}

.slider:before {
    position: absolute;
    content: "";
    height: 20px;
    width: 20px;
    left: 2px;
    bottom: 2px;
    background-color: white;
    transition: .4s;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

input:checked+.slider {
    background-color: #4f46e5;
}

input:checked+.slider:before {
    transform: translateX(20px);
}

.slider.round {
    border-radius: 24px;
}

.slider.round:before {
    border-radius: 50%;
}

.footer-actions {
    display: flex;
    justify-content: space-between;
    margin-top: 8px;
}

.btn-text-only {
    background: none;
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: rgba(255, 255, 255, 0.7);
    padding: 8px 16px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 13px;
    flex: 1;
    margin-right: 8px;
    transition: all 0.2s;
}

.btn-text-only:hover {
    background: rgba(255, 255, 255, 0.1);
    color: #fff;
    border-color: rgba(255, 255, 255, 0.4);
}

.btn-danger-text {
    background: rgba(239, 68, 68, 0.1);
    border: 1px solid rgba(239, 68, 68, 0.3);
    color: #fca5a5;
    padding: 8px 16px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 13px;
    flex: 1;
    transition: all 0.2s;
}

.btn-danger-text:hover {
    background: rgba(239, 68, 68, 0.2);
    color: #fca5a5;
}

/* Leaderboard Tabs */
.leaderboard-tabs {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin: 15px 0 10px 0;
    padding: 0 10px;
}

.lb-tab {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    color: rgba(255, 255, 255, 0.6);
    padding: 8px 16px;
    border-radius: 20px;
    font-size: 0.9em;
    cursor: pointer;
    transition: all 0.3s ease;
}

.lb-tab:hover {
    background: rgba(255, 255, 255, 0.1);
    color: #fff;
    transform: translateY(-2px);
}

.lb-tab.active {
    background: linear-gradient(135deg, #00d4ff, #0077cd);
    color: #fff;
    border-color: transparent;
    box-shadow: 0 4px 15px rgba(0, 212, 255, 0.3);
}

.leaderboard-item .lb-tier {
    font-size: 0.8em;
    font-weight: bold;
    margin-top: 4px;
}

/* Language Select Options */
.language-select option {
    background: #2a2a40;
    color: white;
}

/* Fix Quick Match Decor Clipping */
.hero-card .card-decor-img {
    right: 20px !important;
    bottom: 10px !important;
    font-size: 5rem !important;
    opacity: 0.2 !important;
    /* Subtle background */
    transform: rotate(-15deg);
}

/* ==========================================================================
   3D COLLISION LOADING SCREEN (OVERRIDE)
   ========================================================================== */

/* Force override old loading screen styles */
.loading-screen {
    background: radial-gradient(circle at center, #1a1a2e 0%, #000000 100%) !important;
    perspective: 1000px !important;
    overflow: hidden !important;
}

/* Background Grid (Subtle) */
.tech-bg-grid {
    position: absolute;
    top: 0;
    left: 0;
    width: 200%;
    height: 200%;
    background-image:
        linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
    background-size: 60px 60px;
    transform: rotateX(60deg) translateY(-100px) translateZ(-500px);
    animation: galaxyMove 40s linear infinite;
    pointer-events: none;
}

@keyframes galaxyMove {
    0% {
        transform: rotateX(60deg) translateY(0) translateZ(-500px);
    }

    100% {
        transform: rotateX(60deg) translateY(60px) translateZ(-500px);
    }
}

.loading-content {
    position: relative;
    z-index: 10;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 30px;
}

/* Logo */
.loading-logo {
    font-size: 3.5em !important;
    font-weight: 900 !important;
    color: #fff !important;
    text-shadow: 0 0 20px rgba(255, 255, 255, 0.5) !important;
    letter-spacing: 4px !important;
    animation: none !important;
    /* Reset old pulse */
}

/* 3D Collision Animation Core */
.loader-3d-container {
    position: relative;
    width: 200px;
    height: 200px;
    transform-style: preserve-3d;
    display: flex;
    justify-content: center;
    align-items: center;
}

.orbit-center {
    position: relative;
    width: 100%;
    height: 100%;
    transform-style: preserve-3d;
    animation: systemRotate 4s linear infinite;
}

.orb-3d {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    margin-top: -20px;
    margin-left: -20px;
    /* 3D Sphere Look */
    box-shadow: inset -5px -5px 10px rgba(0, 0, 0, 0.8), 0 0 15px rgba(255, 255, 255, 0.2);
}

.orb-black {
    background: radial-gradient(circle at 30% 30%, #444, #000);
    animation: orbitBlack 1.5s ease-in-out infinite alternate;
}

.orb-white {
    background: radial-gradient(circle at 30% 30%, #fff, #ccc);
    animation: orbitWhite 1.5s ease-in-out infinite alternate;
}

/* Entanglement / Collision Animation */
@keyframes orbitBlack {
    0% {
        transform: translateX(-60px) translateZ(0) scale(1);
    }

    50% {
        transform: translateX(0) translateZ(40px) scale(0.8);
    }

    /* Collide near */
    100% {
        transform: translateX(60px) translateZ(0) scale(1);
    }
}

@keyframes orbitWhite {
    0% {
        transform: translateX(60px) translateZ(0) scale(1);
    }

    50% {
        transform: translateX(0) translateZ(-40px) scale(0.8);
    }

    /* Collide far */
    100% {
        transform: translateX(-60px) translateZ(0) scale(1);
    }
}

@keyframes systemRotate {
    0% {
        transform: rotateZ(0deg) rotateX(20deg);
    }

    100% {
        transform: rotateZ(360deg) rotateX(20deg);
    }
}

.collision-flash {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 20px;
    height: 20px;
    background: radial-gradient(circle, #fff, transparent);
    transform: translate(-50%, -50%);
    opacity: 0;
    box-shadow: 0 0 40px 20px rgba(255, 255, 255, 0.8);
    animation: flash 1.5s ease-in-out infinite alternate;
    /* Syncs with collision */
}

@keyframes flash {

    0%,
    100% {
        opacity: 0;
        transform: translate(-50%, -50%) scale(0.5);
    }

    50% {
        opacity: 1;
        transform: translate(-50%, -50%) scale(2);
    }

    /* Flash at overlap */
}

/* Loading Data Text */
.loading-text-wrapper {
    margin-top: 10px;
    text-align: center;
}

.loading-text {
    color: #00d4ff;
    font-size: 1.2em;
    font-weight: bold;
    letter-spacing: 1px;
}

.loading-subloade {
    color: rgba(255, 255, 255, 0.4);
    font-size: 0.8em;
    margin-top: 5px;
}

/* Clean Bar */
.loading-bar-container {
    width: 320px;
}

.loading-bar-tech {
    height: 4px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 2px;
    overflow: hidden;
}

.loading-progress-tech {
    width: 0%;
    height: 100%;
    background: #00d4ff;
    box-shadow: 0 0 10px #00d4ff;
    transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.loading-percentage {
    text-align: right;
    color: #00d4ff;
    font-size: 0.8em;
    margin-top: 5px;
}

.loading-tip.tech-tip {
    font-family: monospace;
    font-size: 0.9em;
    color: rgba(255, 255, 255, 0.6);
    margin-top: 20px;
    border-left: 2px solid #ff00c1;
    padding-left: 10px;
    text-align: left;
    max-width: 300px;
    animation: fadeIn 0.5s ease-out;
}

/* ========== PWA Install Modal ========== */
.pwa-content {
    text-align: center;
    padding: 30px 20px !important;
    max-width: 90%;
    width: 360px;
}

.pwa-header {
    margin-bottom: 20px;
}

.app-icon-preview {
    width: 80px;
    height: 80px;
    margin: 0 auto 15px;
    border-radius: 20px;
    overflow: hidden;
    background: #000;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 40px;
}

.default-icon {
    font-size: 48px;
    background: linear-gradient(135deg, #2b2b40 0%, #1a1a2e 100%);
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
}

.pwa-header h3 {
    margin: 0;
    font-size: 1.4em;
    color: #fff;
    font-weight: 600;
}

.pwa-content p {
    color: rgba(255, 255, 255, 0.8);
    font-size: 0.95em;
    line-height: 1.5;
    margin-bottom: 25px;
}

.pwa-actions {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.pwa-actions .menu-btn {
    width: 100%;
    margin: 0;
    padding: 14px;
    font-size: 1em;
}

/* iOS Guide */
.pwa-ios-guide {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    padding: 20px;
    margin-top: 20px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.pwa-ios-guide p {
    margin-bottom: 12px;
    font-size: 0.9em;
    text-align: left;
    display: flex;
    align-items: center;
    gap: 8px;
    justify-content: center;
}

.ios-share-icon,
.ios-add-icon {
    display: inline-flex;
    justify-content: center;
    align-items: center;
    width: 24px;
    height: 24px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 6px;
    font-size: 16px;
    font-weight: bold;
}

@keyframes slideUp {
    from {
        transform: translateY(50px);
        opacity: 0;
    }

    to {
        transform: translateY(0);
        opacity: 1;
    }
}

.modal-content.slide-up {
    animation: slideUp 0.4s cubic-bezier(0.19, 1, 0.22, 1);
}

/* ========== Version Announcement Modal ========== */
.version-content {
    text-align: left;
    padding: 30px !important;
    max-width: 90%;
    width: 450px;
}

.version-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 25px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    padding-bottom: 15px;
}

.version-header h2 {
    margin: 0;
    font-size: 1.5em;
    background: linear-gradient(90deg, #fff, #a0d8ef);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.version-date {
    font-size: 0.9em;
    color: rgba(255, 255, 255, 0.5);
    background: rgba(255, 255, 255, 0.1);
    padding: 4px 10px;
    border-radius: 20px;
}

.version-list {
    display: flex;
    flex-direction: column;
    gap: 15px;
    margin-bottom: 30px;
}

.version-item {
    display: flex;
    gap: 15px;
    padding: 15px;
    background: rgba(255, 255, 255, 0.03);
    border-radius: 12px;
    transition: all 0.3s ease;
    border: 1px solid rgba(255, 255, 255, 0.05);
}

.version-item:hover {
    background: rgba(255, 255, 255, 0.06);
    transform: translateX(5px);
}

.version-item .v-icon {
    font-size: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 10px;
    flex-shrink: 0;
}

.version-item .v-text {
    flex: 1;
}

.version-item h4 {
    margin: 0 0 5px 0;
    color: #fff;
    font-size: 1.1em;
}

.version-item p {
    margin: 0;
    color: rgba(255, 255, 255, 0.6);
    font-size: 0.9em;
    line-height: 1.4;
}

.version-footer {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 15px;
}

.version-footer .menu-btn {
    width: 100%;
    margin: 0;
    font-size: 1.1em;
    padding: 16px;
    background: linear-gradient(135deg, #00d4ff 0%, #005bea 100%);
    box-shadow: 0 5px 20px rgba(0, 212, 255, 0.3);
}

.version-footer .menu-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0, 212, 255, 0.4);
} 
 
/* ========== 留言板增强样式 ========== */

/* 提交按钮禁用和加载状态 */
.feedback-submit-btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none !important;
}

.feedback-submit-btn.loading {
    background: linear-gradient(135deg, rgba(100, 100, 100, 0.5), rgba(80, 80, 80, 0.5));
}

/* 留言类型选择行 */
.feedback-type-row {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 12px;
}

.feedback-type-row label {
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.9em;
    white-space: nowrap;
}

.feedback-type-select {
    flex: 1;
    padding: 8px 12px;
    background: rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 8px;
    color: #fff;
    font-size: 0.95em;
    outline: none;
    cursor: pointer;
    transition: border-color 0.3s;
}

.feedback-type-select:focus {
    border-color: #00d4ff;
}

.feedback-type-select option {
    background: #1a1a2e;
    color: #fff;
}
